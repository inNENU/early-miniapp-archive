"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var wxpage_1 = require("wxpage");
var component_1 = require("../utils/component");
var file_1 = require("../utils/file");
var page_1 = require("../utils/page");
var a = getApp().globalData;
var special = [
    { text: '引体向上', unit: '个', type: 'number', id: 'chinning' },
    { text: '仰卧起坐', unit: '个', type: 'number', id: 'situp' }
];
var longRunText = ['1000米跑', '800米跑'];
var longRunPicker = [['2分', '3分', '4分', '5分', '6分', '7分'], []];
for (var i = 0; i < 60; i++)
    longRunPicker[1].push(i + "\u79D2");
wxpage_1.default('PEcal', {
    data: {
        T: a.T,
        nm: a.nm,
        page: [{ tag: 'head', title: '体测计算器', grey: true, leftText: '功能大厅' }],
        gender: {
            picker: ['男', '女'],
            value: ['male', 'female']
        },
        grade: {
            picker: ['大一', '大二', '大三', '大四'],
            value: ['Low', 'Low', 'High', 'High']
        },
        list: [
            { text: '身高', unit: '厘米', type: 'number', id: 'height' },
            { text: '体重', unit: '千克', type: 'digit', id: 'weight' },
            { text: '坐位体前屈', unit: '厘米', type: 'digit', id: 'sitAndReach' },
            { text: '肺活量', unit: '毫升', type: 'number', id: 'vitalCapacity' },
            { text: '立定跳远', unit: '米', type: 'digit', id: 'standingLongJump' },
            { text: '50米跑', unit: '秒', type: 'digit', id: 'shortRun' }
        ],
        longRun: { text: '800米跑' },
        special: { text: '仰卧起坐', unit: '个', id: 'situp' },
        PEscore: {},
        result: {},
        scoreList: [
            { text: 'BMI', id: 'BMI' },
            { text: '坐位体前屈', id: 'sitAndReach' },
            { text: '肺活量', id: 'vitalCapacity' },
            { text: '立定跳远', id: 'standingLongJump' },
            { text: '50米跑', id: 'shortRun' }
        ]
    },
    onLoad: function (option) {
        page_1.default.Set({ option: option, ctx: this }, this.data.page);
        var genderIndex = wx.getStorageSync('gender');
        var gradeIndex = wx.getStorageSync('grade');
        if (genderIndex || genderIndex === 0)
            this.setData({
                'gender.index': genderIndex,
                'longRun.text': genderIndex === 0 ? longRunText[0] : longRunText[1],
                special: genderIndex === 0 ? special[0] : special[1],
                'result.gender': this.data.gender.value[genderIndex]
            });
        if (gradeIndex || gradeIndex === 0)
            this.setData({
                'grade.index': gradeIndex,
                'result.grade': this.data.grade.value[gradeIndex]
            });
        this.setData({ 'longRun.picker': longRunPicker });
        var _a = page_1.default.color(true), nc = _a.nc, bc = _a.bc;
        wx.setNavigationBarColor(nc);
        wx.setBackgroundColor(bc);
        page_1.default.Notice('PEcal');
    },
    onPageScroll: function (e) {
        component_1.default.nav(e, this);
    },
    cA: function (e) {
        component_1.default.trigger(e, this);
    },
    genderChange: function (event) {
        var index = Number(event.detail.value);
        var gender = this.data.gender.value[index];
        wx.setStorageSync('gender', index);
        this.setData({
            'result.gender': gender,
            'gender.index': index,
            special: gender === 'male' ? special[0] : special[1],
            'longRun.text': gender === 'male' ? longRunText[0] : longRunText[1]
        });
    },
    gradeChange: function (event) {
        var index = Number(event.detail.value);
        this.setData({
            'grade.index': index,
            'result.grade': this.data.grade.value[index]
        });
        wx.setStorageSync('grade', index);
    },
    focus: function (event) {
        console.log('focus', event);
        var id = event.currentTarget.id;
        var query = wx.createSelectorQuery();
        this.setData({ input: { status: true, height: event.detail.height } });
        query.select("#" + id)
            .boundingClientRect();
        query.selectViewport().fields({ size: true, scrollOffset: true });
        query.exec(function (res) {
            console.log(res);
            console.log('bottom是', res[0].bottom);
            console.log('scrollTop是', res[1].scrollTop);
            console.log('键盘高度是', event.detail.height);
            console.log('屏幕高度为', res[1].height);
            console.log(res[0].bottom + event.detail.height > res[1].height);
            if (res[0].bottom + event.detail.height > res[1].height) {
                console.log('scroll');
                console.log('计划向上滚动', res[0].bottom + event.detail.height - res[1].height + 10);
                console.log('新的应为', res[1].scrollTop + res[0].bottom + event.detail.height - res[1].height + 10);
                wx.pageScrollTo({ scrollTop: res[1].scrollTop + res[0].bottom + event.detail.height - res[1].height + 10 });
            }
        });
    },
    input: function (event) {
        var _a;
        console.log(event);
        var project = event.currentTarget.id;
        this.setData((_a = {}, _a["result." + project] = event.detail.value, _a));
    },
    blur: function () {
        this.setData({ 'input.status': false });
    },
    longRunHandler: function (event) {
        var value = event.detail.value;
        this.setData({
            'longRun.value': longRunPicker[0][value[0]] + " " + longRunPicker[1][value[1]],
            'result.longRun': (value[0] + 2) * 60 + value[1]
        });
    },
    calculate: function () {
        var _a;
        var _this = this;
        var result = this.data.result;
        wx.showLoading({ title: '计算中...', mask: true });
        console.info('输入结果为：', result);
        if (result.gender && result.grade) {
            var hash_1 = [10, 20, 30, 40, 50, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 85, 90, 95, 100];
            var length_1 = hash_1.length;
            var PEscore_1 = {
                BMI: 0,
                vitalCapacity: 0,
                sitAndReach: 0,
                standingLongJump: 0,
                shortRun: 0,
                longRun: 0,
                special: 0,
                passScore: 60
            };
            if (result.height && result.weight) {
                var state = void 0;
                var score = Math.round(result.weight * 100000 / result.height / result.height) / 10;
                _a = result.gender === 'male'
                    ? score <= 17.8 ? ['低体重', 80] : score >= 28.0 ? ['肥胖', 60] : score >= 24.0 ? ['超重', 80] : ['正常', 100]
                    : score <= 17.1 ? ['低体重', 80] : score >= 28.0 ? ['肥胖', 60] : score >= 24.0 ? ['超重', 80] : ['正常', 100], state = _a[0], PEscore_1.BMI = _a[1];
                PEscore_1.passScore = result.grade === 'Low'
                    ? score <= 28 ? 60 : 60 - Math.ceil(score - 28) * 2
                    : 50;
                this.setData({ BMI: { score: score, state: state } });
            }
            file_1.default.getJson("function/PEcal/" + result.gender + result.grade, function (config) {
                config.longRun = config.longRun.map(function (element) {
                    var time = element.split('-');
                    return Number(time[0]) * 60 + Number(time[1]);
                });
                config.standingLongJump = config.standingLongJump.map(function (element) { return element / 100; });
                console.log(config);
                ['vitalCapacity', 'sitAndReach', 'standingLongJump'].forEach(function (x) {
                    if (result[x]) {
                        for (var i = 0; i < length_1; i++)
                            if (result[x] <= config[x][i]) {
                                PEscore_1[x] = hash_1[i];
                                break;
                            }
                            else if (i === length_1 - 1)
                                PEscore_1[x] = hash_1[i];
                    }
                    else
                        PEscore_1[x] = 0;
                });
                ['shortRun', 'longRun'].forEach(function (x) {
                    if (result[x]) {
                        for (var i = 0; i < length_1; i++)
                            if (result[x] >= config[x][i]) {
                                PEscore_1[x] = hash_1[i];
                                break;
                            }
                            else if (i === length_1 - 1)
                                PEscore_1[x] = hash_1[i];
                    }
                    else
                        PEscore_1[x] = 0;
                });
                var specialScore = result.gender === 'male' ? 'chinning' : 'situp';
                for (var i = 0; i < length_1; i++)
                    if (result[specialScore]) {
                        if (config[specialScore][i] !== '' && result[specialScore] && result[specialScore] <= config[specialScore][i]) {
                            PEscore_1.special = hash_1[i];
                            break;
                        }
                        else if (i === length_1 - 1)
                            PEscore_1.special = hash_1[i];
                    }
                    else
                        PEscore_1.special = 0;
                var finalScore = Math.round(PEscore_1.vitalCapacity * 15 + PEscore_1.shortRun * 20 + PEscore_1.sitAndReach * 10 +
                    PEscore_1.standingLongJump * 10 + PEscore_1.special * 10 + PEscore_1.longRun * 20 +
                    PEscore_1.BMI * 15) / 100;
                console.info('成绩为', PEscore_1);
                _this.setData({
                    showScore: true,
                    PEscore: PEscore_1,
                    PE: {
                        score: finalScore,
                        state: finalScore >= PEscore_1.passScore ? '及格' : '不及格'
                    }
                });
            });
            wx.hideLoading();
        }
        else {
            wx.hideLoading();
            wx.showToast({ title: '请选择性别年级', icon: 'none', duration: 2500, image: '/icon/close.png' });
        }
    },
    navigate: function () {
        this.$route('/module/module1?From=体测计算器&aim=test0&depth=1');
    },
    redirect: function () {
        this.$launch('/page/main');
    },
    onShareAppMessage: function () { return ({ title: '体测计算器', path: '/function/PEcal?share=true' }); }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUEVjYWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJQRWNhbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQU9BLGlDQUErQjtBQUMvQixnREFBNEM7QUFDNUMsc0NBQWtDO0FBQ2xDLHNDQUFrQztBQUMxQixJQUFBLHVCQUFhLENBQWM7QUFFbkMsSUFBTSxPQUFPLEdBQUc7SUFDZCxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxVQUFVLEVBQUU7SUFDM0QsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFO0NBQ3pELENBQUM7QUFDRixJQUFNLFdBQVcsR0FBRyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUN4QyxJQUFNLGFBQWEsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztBQUVqRSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRTtJQUFFLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUksQ0FBQyxXQUFHLENBQUMsQ0FBQztBQUU1RCxnQkFBUyxDQUFDLE9BQU8sRUFBRTtJQUNqQixJQUFJLEVBQUU7UUFDSixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDTixFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUU7UUFDUixJQUFJLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsQ0FBQztRQUNyRSxNQUFNLEVBQUU7WUFD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Z0JBRTFCLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLFNBQU8sQ0FBQyxDQUFDO2dCQUM3QixLQUFJLENBQUMsT0FBUSxDQUFDO29CQUNaLFNBQVMsRUFBRSxJQUFJO29CQUNmLE9BQU8sV0FBQTtvQkFDUCxFQUFFLEVBQUU7d0JBQ0YsS0FBSyxFQUFFLFVBQVU7d0JBQ2pCLEtBQUssRUFBRSxVQUFVLElBQUksU0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLO3FCQUN0RDtpQkFDRixDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztZQUNILEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNsQjthQUFNO1lBQ0wsRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2pCLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO1NBQzVGO0lBQ0gsQ0FBQztJQUNELFFBQVE7UUFDTixJQUFJLENBQUMsTUFBTSxDQUFDLDhDQUE4QyxDQUFDLENBQUM7SUFDOUQsQ0FBQztJQUVELFFBQVE7UUFDTixJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFDRCxpQkFBaUIsRUFBRSxjQUFNLE9BQUEsQ0FBQyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLDRCQUE0QixFQUFFLENBQUMsRUFBeEQsQ0FBd0Q7Q0FDbEYsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIEBBdXRob3I6IE1yLkhvcGVcbiAqIEBEYXRlOiAyMDE5LTA2LTI0IDIxOjE0OjExXG4gKiBATGFzdEVkaXRvcnM6IE1yLkhvcGVcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMDYtMjUgMTk6MzM6MDRcbiAqIEBEZXNjcmlwdGlvbjog5L2T5rWL6K6h566X5ZmoXG4gKi9cbmltcG9ydCAkcmVnaXN0ZXIgZnJvbSAnd3hwYWdlJztcbmltcG9ydCAkY29tcG9uZW50IGZyb20gJy4uL3V0aWxzL2NvbXBvbmVudCc7XG5pbXBvcnQgJGZpbGUgZnJvbSAnLi4vdXRpbHMvZmlsZSc7XG5pbXBvcnQgJHBhZ2UgZnJvbSAnLi4vdXRpbHMvcGFnZSc7XG5jb25zdCB7IGdsb2JhbERhdGE6IGEgfSA9IGdldEFwcCgpO1xuXG5jb25zdCBzcGVjaWFsID0gW1xuICB7IHRleHQ6ICflvJXkvZPlkJHkuIonLCB1bml0OiAn5LiqJywgdHlwZTogJ251bWJlcicsIGlkOiAnY2hpbm5pbmcnIH0sXG4gIHsgdGV4dDogJ+S7sOWNp+i1t+WdkCcsIHVuaXQ6ICfkuKonLCB0eXBlOiAnbnVtYmVyJywgaWQ6ICdzaXR1cCcgfVxuXTtcbmNvbnN0IGxvbmdSdW5UZXh0ID0gWycxMDAw57Gz6LeRJywgJzgwMOexs+i3kSddO1xuY29uc3QgbG9uZ1J1blBpY2tlciA9IFtbJzLliIYnLCAnM+WIhicsICc05YiGJywgJzXliIYnLCAnNuWIhicsICc35YiGJ10sIFtdXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCA2MDsgaSsrKSBsb25nUnVuUGlja2VyWzFdLnB1c2goYCR7aX3np5JgKTtcblxuJHJlZ2lzdGVyKCdQRWNhbCcsIHtcbiAgZGF0YToge1xuICAgIFQ6IGEuVCxcbiAgICBubTogYS5ubSxcbiAgICBwYWdlOiBbeyB0YWc6ICdoZWFkJywgdGl0bGU6ICfkvZPmtYvorqHnrpflmagnLCBncmV5OiB0cnVlLCBsZWZ0VGV4dDogJ+WKn+iDveWkp+WOhScgfV0sXG4gICAgZ2VuZGVyOiB7XG4gICAgICBwaWNrZXI6IFsn55S3JywgJ+WlsyddLFxuICAgICAgdmFsdWU6IFsnbWFsZScsICdmZW1hbGUnXVxuICAgIH0sXG4gICAgZ3JhZGU6IHtcbiAgICAgIHBpY2tlcjogWyflpKfkuIAnLCAn5aSn5LqMJywgJ+Wkp+S4iScsICflpKflm5snXSxcbiAgICAgIHZhbHVlOiBbJ0xvdycsICdMb3cnLCAnSGlnaCcsICdIaWdoJ11cbiAgICB9LFxuICAgIGxpc3Q6IFtcbiAgICAgIHsgdGV4dDogJ+i6q+mrmCcsIHVuaXQ6ICfljpjnsbMnLCB0eXBlOiAnbnVtYmVyJywgaWQ6ICdoZWlnaHQnIH0sXG4gICAgICB7IHRleHQ6ICfkvZPph40nLCB1bml0OiAn5Y2D5YWLJywgdHlwZTogJ2RpZ2l0JywgaWQ6ICd3ZWlnaHQnIH0sXG4gICAgICB7IHRleHQ6ICflnZDkvY3kvZPliY3lsYgnLCB1bml0OiAn5Y6Y57GzJywgdHlwZTogJ2RpZ2l0JywgaWQ6ICdzaXRBbmRSZWFjaCcgfSxcbiAgICAgIHsgdGV4dDogJ+iCuua0u+mHjycsIHVuaXQ6ICfmr6vljYcnLCB0eXBlOiAnbnVtYmVyJywgaWQ6ICd2aXRhbENhcGFjaXR5JyB9LFxuICAgICAgeyB0ZXh0OiAn56uL5a6a6Lez6L+cJywgdW5pdDogJ+exsycsIHR5cGU6ICdkaWdpdCcsIGlkOiAnc3RhbmRpbmdMb25nSnVtcCcgfSxcbiAgICAgIHsgdGV4dDogJzUw57Gz6LeRJywgdW5pdDogJ+enkicsIHR5cGU6ICdkaWdpdCcsIGlkOiAnc2hvcnRSdW4nIH1cbiAgICBdLFxuICAgIGxvbmdSdW46IHsgdGV4dDogJzgwMOexs+i3kScgfSxcbiAgICBzcGVjaWFsOiB7IHRleHQ6ICfku7DljafotbflnZAnLCB1bml0OiAn5LiqJywgaWQ6ICdzaXR1cCcgfSxcbiAgICBQRXNjb3JlOiB7fSxcbiAgICByZXN1bHQ6IHt9LFxuICAgIHNjb3JlTGlzdDogW1xuICAgICAgeyB0ZXh0OiAnQk1JJywgaWQ6ICdCTUknIH0sXG4gICAgICB7IHRleHQ6ICflnZDkvY3kvZPliY3lsYgnLCBpZDogJ3NpdEFuZFJlYWNoJyB9LFxuICAgICAgeyB0ZXh0OiAn6IK65rS76YePJywgaWQ6ICd2aXRhbENhcGFjaXR5JyB9LFxuICAgICAgeyB0ZXh0OiAn56uL5a6a6Lez6L+cJywgaWQ6ICdzdGFuZGluZ0xvbmdKdW1wJyB9LFxuICAgICAgeyB0ZXh0OiAnNTDnsbPot5EnLCBpZDogJ3Nob3J0UnVuJyB9XG4gICAgXVxuICB9LFxuICBvbkxvYWQob3B0aW9uOiBhbnkpIHtcbiAgICAkcGFnZS5TZXQoeyBvcHRpb24sIGN0eDogdGhpcyB9LCB0aGlzLmRhdGEucGFnZSk7XG4gICAgY29uc3QgZ2VuZGVySW5kZXggPSB3eC5nZXRTdG9yYWdlU3luYygnZ2VuZGVyJyk7XG4gICAgY29uc3QgZ3JhZGVJbmRleCA9IHd4LmdldFN0b3JhZ2VTeW5jKCdncmFkZScpO1xuXG4gICAgLy8g5bCG55So5oi35LiK5qyh6YCJ5oup55qE5oCn5Yir5ZKM5bm057qn6L295YWlXG4gICAgaWYgKGdlbmRlckluZGV4IHx8IGdlbmRlckluZGV4ID09PSAwKSAgLy8g5pS55Y+Y54m55Yir6aG555uu5ZKM6ZW/6LeR55qE5ZCN56ewXG4gICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgJ2dlbmRlci5pbmRleCc6IGdlbmRlckluZGV4LFxuICAgICAgICAnbG9uZ1J1bi50ZXh0JzogZ2VuZGVySW5kZXggPT09IDAgPyBsb25nUnVuVGV4dFswXSA6IGxvbmdSdW5UZXh0WzFdLFxuICAgICAgICBzcGVjaWFsOiBnZW5kZXJJbmRleCA9PT0gMCA/IHNwZWNpYWxbMF0gOiBzcGVjaWFsWzFdLFxuICAgICAgICAncmVzdWx0LmdlbmRlcic6IHRoaXMuZGF0YS5nZW5kZXIudmFsdWVbZ2VuZGVySW5kZXhdXG4gICAgICB9KTtcblxuICAgIGlmIChncmFkZUluZGV4IHx8IGdyYWRlSW5kZXggPT09IDApIC8vIOWGmeWFpeW5tOe6p1xuICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgICdncmFkZS5pbmRleCc6IGdyYWRlSW5kZXgsXG4gICAgICAgICdyZXN1bHQuZ3JhZGUnOiB0aGlzLmRhdGEuZ3JhZGUudmFsdWVbZ3JhZGVJbmRleF1cbiAgICAgIH0pO1xuXG4gICAgLy8g6K6+572u6ZW/6LeR6YCJ5oup5Zmo5pWw5o2uXG4gICAgdGhpcy5zZXREYXRhISh7ICdsb25nUnVuLnBpY2tlcic6IGxvbmdSdW5QaWNrZXIgfSk7XG5cbiAgICAvLyDorr7nva7og7blm4rlkozog4zmma/popzoibJcbiAgICBjb25zdCB7IG5jLCBiYyB9ID0gJHBhZ2UuY29sb3IodHJ1ZSk7XG5cbiAgICB3eC5zZXROYXZpZ2F0aW9uQmFyQ29sb3IobmMpO1xuICAgIHd4LnNldEJhY2tncm91bmRDb2xvcihiYyk7XG5cbiAgICAvLyDorr7nva7pgJrnn6VcbiAgICAkcGFnZS5Ob3RpY2UoJ1BFY2FsJyk7XG4gIH0sXG4gIG9uUGFnZVNjcm9sbChlKSB7XG4gICAgJGNvbXBvbmVudC5uYXYoZSwgdGhpcyk7XG4gIH0sXG4gIGNBKGU6IGFueSkge1xuICAgICRjb21wb25lbnQudHJpZ2dlcihlLCB0aGlzKTtcbiAgfSxcbiAgZ2VuZGVyQ2hhbmdlKGV2ZW50OiBhbnkpIHtcbiAgICBjb25zdCBpbmRleCA9IE51bWJlcihldmVudC5kZXRhaWwudmFsdWUpO1xuICAgIGNvbnN0IGdlbmRlciA9IHRoaXMuZGF0YS5nZW5kZXIudmFsdWVbaW5kZXhdO1xuXG4gICAgd3guc2V0U3RvcmFnZVN5bmMoJ2dlbmRlcicsIGluZGV4KTtcblxuICAgIC8vIOaUueWPmOeJueWIq+mhueebruWSjOmVv+i3keeahOWQjeensFxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgJ3Jlc3VsdC5nZW5kZXInOiBnZW5kZXIsXG4gICAgICAnZ2VuZGVyLmluZGV4JzogaW5kZXgsXG4gICAgICBzcGVjaWFsOiBnZW5kZXIgPT09ICdtYWxlJyA/IHNwZWNpYWxbMF0gOiBzcGVjaWFsWzFdLFxuICAgICAgJ2xvbmdSdW4udGV4dCc6IGdlbmRlciA9PT0gJ21hbGUnID8gbG9uZ1J1blRleHRbMF0gOiBsb25nUnVuVGV4dFsxXVxuICAgIH0pO1xuICB9LFxuICBncmFkZUNoYW5nZShldmVudDogYW55KSB7XG4gICAgY29uc3QgaW5kZXggPSBOdW1iZXIoZXZlbnQuZGV0YWlsLnZhbHVlKTtcblxuICAgIC8vIOiuvue9ruW5tOe6p1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgJ2dyYWRlLmluZGV4JzogaW5kZXgsXG4gICAgICAncmVzdWx0LmdyYWRlJzogdGhpcy5kYXRhLmdyYWRlLnZhbHVlW2luZGV4XVxuICAgIH0pO1xuICAgIHd4LnNldFN0b3JhZ2VTeW5jKCdncmFkZScsIGluZGV4KTtcbiAgfSxcbiAgZm9jdXMoZXZlbnQ6IGFueSkge1xuICAgIGNvbnNvbGUubG9nKCdmb2N1cycsIGV2ZW50KTtcbiAgICBjb25zdCB7IGlkIH0gPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgIGNvbnN0IHF1ZXJ5ID0gd3guY3JlYXRlU2VsZWN0b3JRdWVyeSgpO1xuXG4gICAgdGhpcy5zZXREYXRhISh7IGlucHV0OiB7IHN0YXR1czogdHJ1ZSwgaGVpZ2h0OiBldmVudC5kZXRhaWwuaGVpZ2h0IH0gfSk7XG5cbiAgICBxdWVyeS5zZWxlY3QoYCMke2lkfWApXG4gICAgICAuYm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgcXVlcnkuc2VsZWN0Vmlld3BvcnQoKS5maWVsZHMoeyBzaXplOiB0cnVlLCBzY3JvbGxPZmZzZXQ6IHRydWUgfSk7XG4gICAgcXVlcnkuZXhlYygocmVzOiBhbnkpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICBjb25zb2xlLmxvZygnYm90dG9t5pivJywgcmVzWzBdLmJvdHRvbSk7XG4gICAgICBjb25zb2xlLmxvZygnc2Nyb2xsVG9w5pivJywgcmVzWzFdLnNjcm9sbFRvcCk7XG4gICAgICBjb25zb2xlLmxvZygn6ZSu55uY6auY5bqm5pivJywgZXZlbnQuZGV0YWlsLmhlaWdodCk7XG4gICAgICBjb25zb2xlLmxvZygn5bGP5bmV6auY5bqm5Li6JywgcmVzWzFdLmhlaWdodCk7XG4gICAgICBjb25zb2xlLmxvZyhyZXNbMF0uYm90dG9tICsgZXZlbnQuZGV0YWlsLmhlaWdodCA+IHJlc1sxXS5oZWlnaHQpO1xuICAgICAgaWYgKHJlc1swXS5ib3R0b20gKyBldmVudC5kZXRhaWwuaGVpZ2h0ID4gcmVzWzFdLmhlaWdodCkge1xuICAgICAgICBjb25zb2xlLmxvZygnc2Nyb2xsJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCforqHliJLlkJHkuIrmu5rliqgnLCByZXNbMF0uYm90dG9tICsgZXZlbnQuZGV0YWlsLmhlaWdodCAtIHJlc1sxXS5oZWlnaHQgKyAxMCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCfmlrDnmoTlupTkuLonLCByZXNbMV0uc2Nyb2xsVG9wICsgcmVzWzBdLmJvdHRvbSArIGV2ZW50LmRldGFpbC5oZWlnaHQgLSByZXNbMV0uaGVpZ2h0ICsgMTApO1xuICAgICAgICB3eC5wYWdlU2Nyb2xsVG8oeyBzY3JvbGxUb3A6IHJlc1sxXS5zY3JvbGxUb3AgKyByZXNbMF0uYm90dG9tICsgZXZlbnQuZGV0YWlsLmhlaWdodCAtIHJlc1sxXS5oZWlnaHQgKyAxMCB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcbiAgaW5wdXQoZXZlbnQ6IGFueSkge1xuICAgIGNvbnNvbGUubG9nKGV2ZW50KTtcbiAgICBjb25zdCBwcm9qZWN0ID0gZXZlbnQuY3VycmVudFRhcmdldC5pZDtcblxuICAgIHRoaXMuc2V0RGF0YSEoeyBbYHJlc3VsdC4ke3Byb2plY3R9YF06IGV2ZW50LmRldGFpbC52YWx1ZSB9KTtcbiAgfSxcbiAgYmx1cigpIHtcbiAgICB0aGlzLnNldERhdGEhKHsgJ2lucHV0LnN0YXR1cyc6IGZhbHNlIH0pO1xuICB9LFxuICBsb25nUnVuSGFuZGxlcihldmVudDogYW55KSB7XG4gICAgY29uc3QgeyB2YWx1ZSB9ID0gZXZlbnQuZGV0YWlsO1xuXG4gICAgLy8g6K6+572u5pi+56S65pWw5o2uXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAnbG9uZ1J1bi52YWx1ZSc6IGAke2xvbmdSdW5QaWNrZXJbMF1bdmFsdWVbMF1dfSAke2xvbmdSdW5QaWNrZXJbMV1bdmFsdWVbMV1dfWAsXG4gICAgICAncmVzdWx0LmxvbmdSdW4nOiAodmFsdWVbMF0gKyAyKSAqIDYwICsgdmFsdWVbMV1cbiAgICB9KTtcblxuXG4gIH0sXG4gIGNhbGN1bGF0ZSgpIHtcbiAgICBjb25zdCB7IHJlc3VsdCB9ID0gdGhpcy5kYXRhO1xuXG4gICAgd3guc2hvd0xvYWRpbmcoeyB0aXRsZTogJ+iuoeeul+S4rS4uLicsIG1hc2s6IHRydWUgfSk7XG4gICAgY29uc29sZS5pbmZvKCfovpPlhaXnu5PmnpzkuLrvvJonLCByZXN1bHQpO1xuXG4gICAgaWYgKHJlc3VsdC5nZW5kZXIgJiYgcmVzdWx0LmdyYWRlKSB7IC8vIOWPr+S7peiuoeeul1xuICAgICAgaW50ZXJmYWNlIFBFU2NvcmUge1xuICAgICAgICBCTUk6IG51bWJlcixcbiAgICAgICAgdml0YWxDYXBhY2l0eTogbnVtYmVyLFxuICAgICAgICBzaXRBbmRSZWFjaDogbnVtYmVyLFxuICAgICAgICBzdGFuZGluZ0xvbmdKdW1wOiBudW1iZXIsXG4gICAgICAgIHNob3J0UnVuOiBudW1iZXIsXG4gICAgICAgIGxvbmdSdW46IG51bWJlcixcbiAgICAgICAgc3BlY2lhbDogbnVtYmVyO1xuICAgICAgICBwYXNzU2NvcmU6IG51bWJlcjtcbiAgICAgICAgW3Byb3BzOiBzdHJpbmddOiBudW1iZXI7XG4gICAgICB9XG5cblxuICAgICAgY29uc3QgaGFzaCA9IFsxMCwgMjAsIDMwLCA0MCwgNTAsIDYwLCA2MiwgNjQsIDY2LCA2OCwgNzAsIDcyLCA3NCwgNzYsIDc4LCA4MCwgODUsIDkwLCA5NSwgMTAwXTtcbiAgICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSBoYXNoO1xuICAgICAgY29uc3QgUEVzY29yZTogUEVTY29yZSA9IHtcbiAgICAgICAgQk1JOiAwLFxuICAgICAgICB2aXRhbENhcGFjaXR5OiAwLFxuICAgICAgICBzaXRBbmRSZWFjaDogMCxcbiAgICAgICAgc3RhbmRpbmdMb25nSnVtcDogMCxcbiAgICAgICAgc2hvcnRSdW46IDAsXG4gICAgICAgIGxvbmdSdW46IDAsXG4gICAgICAgIHNwZWNpYWw6IDAsXG4gICAgICAgIHBhc3NTY29yZTogNjBcbiAgICAgIH07XG5cbiAgICAgIGlmIChyZXN1bHQuaGVpZ2h0ICYmIHJlc3VsdC53ZWlnaHQpIHsgLy8g5Y+v5Lul6K6h566XQk1JXG4gICAgICAgIGxldCBzdGF0ZTtcbiAgICAgICAgY29uc3Qgc2NvcmUgPSBNYXRoLnJvdW5kKHJlc3VsdC53ZWlnaHQgKiAxMDAwMDAgLyByZXN1bHQuaGVpZ2h0IC8gcmVzdWx0LmhlaWdodCkgLyAxMDtcblxuICAgICAgICAvLyDorqHnrpdCTUnnirbmgIHkuI7liIblgLxcbiAgICAgICAgW3N0YXRlLCBQRXNjb3JlLkJNSV0gPSByZXN1bHQuZ2VuZGVyID09PSAnbWFsZSdcbiAgICAgICAgICA/IHNjb3JlIDw9IDE3LjggPyBbJ+S9juS9k+mHjScsIDgwXSA6IHNjb3JlID49IDI4LjAgPyBbJ+iCpeiDlicsIDYwXSA6IHNjb3JlID49IDI0LjAgPyBbJ+i2hemHjScsIDgwXSA6IFsn5q2j5bi4JywgMTAwXVxuICAgICAgICAgIDogc2NvcmUgPD0gMTcuMSA/IFsn5L2O5L2T6YeNJywgODBdIDogc2NvcmUgPj0gMjguMCA/IFsn6IKl6IOWJywgNjBdIDogc2NvcmUgPj0gMjQuMCA/IFsn6LaF6YeNJywgODBdIDogWyfmraPluLgnLCAxMDBdO1xuXG4gICAgICAgIC8vIOiuoeeul+WPiuagvOWIhuaVsFxuICAgICAgICBQRXNjb3JlLnBhc3NTY29yZSA9IHJlc3VsdC5ncmFkZSA9PT0gJ0xvdydcbiAgICAgICAgICA/IHNjb3JlIDw9IDI4ID8gNjAgOiA2MCAtIE1hdGguY2VpbChzY29yZSAtIDI4KSAqIDJcbiAgICAgICAgICA6IDUwO1xuXG4gICAgICAgIHRoaXMuc2V0RGF0YSEoeyBCTUk6IHsgc2NvcmUsIHN0YXRlIH0gfSk7XG4gICAgICB9XG5cbiAgICAgICRmaWxlLmdldEpzb24oYGZ1bmN0aW9uL1BFY2FsLyR7cmVzdWx0LmdlbmRlcn0ke3Jlc3VsdC5ncmFkZX1gLCAoY29uZmlnOiBhbnkpID0+IHsgLy8g6K+75Y+W55u45bqU6YWN572u5paH5Lu2XG5cbiAgICAgICAgLy8g6L2s5o2i6ZW/6LeR5pe26Ze0XG4gICAgICAgIGNvbmZpZy5sb25nUnVuID0gY29uZmlnLmxvbmdSdW4ubWFwKChlbGVtZW50OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICBjb25zdCB0aW1lID0gZWxlbWVudC5zcGxpdCgnLScpO1xuXG4gICAgICAgICAgcmV0dXJuIE51bWJlcih0aW1lWzBdKSAqIDYwICsgTnVtYmVyKHRpbWVbMV0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyDovazmjaLnq4vlrprot7Pov5zljZXkvY1cbiAgICAgICAgY29uZmlnLnN0YW5kaW5nTG9uZ0p1bXAgPSBjb25maWcuc3RhbmRpbmdMb25nSnVtcC5tYXAoKGVsZW1lbnQ6IG51bWJlcikgPT4gZWxlbWVudCAvIDEwMCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coY29uZmlnKTtcblxuICAgICAgICAvLyDku6XkuIvkuInpobnotorpq5jotorlpb3vvIzov5vooYzorqHnrpdcbiAgICAgICAgWyd2aXRhbENhcGFjaXR5JywgJ3NpdEFuZFJlYWNoJywgJ3N0YW5kaW5nTG9uZ0p1bXAnXS5mb3JFYWNoKHggPT4ge1xuICAgICAgICAgIGlmIChyZXN1bHRbeF0pIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgIGlmIChyZXN1bHRbeF0gPD0gY29uZmlnW3hdW2ldKSB7XG4gICAgICAgICAgICAgICAgUEVzY29yZVt4XSA9IGhhc2hbaV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gbGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgICBQRXNjb3JlW3hdID0gaGFzaFtpXTtcbiAgICAgICAgICB9IGVsc2UgUEVzY29yZVt4XSA9IDA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIOS7peS4i+S4pOmhuei2iuS9jui2iuWlvVxuICAgICAgICBbJ3Nob3J0UnVuJywgJ2xvbmdSdW4nXS5mb3JFYWNoKHggPT4ge1xuICAgICAgICAgIGlmIChyZXN1bHRbeF0pIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgIGlmIChyZXN1bHRbeF0gPj0gY29uZmlnW3hdW2ldKSB7XG4gICAgICAgICAgICAgICAgUEVzY29yZVt4XSA9IGhhc2hbaV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gbGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgICBQRXNjb3JlW3hdID0gaGFzaFtpXTtcbiAgICAgICAgICB9IGVsc2UgUEVzY29yZVt4XSA9IDA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIOiuoeeul+eJueWIq+exu+mhueebruWIhuaVsFxuICAgICAgICBjb25zdCBzcGVjaWFsU2NvcmUgPSByZXN1bHQuZ2VuZGVyID09PSAnbWFsZScgPyAnY2hpbm5pbmcnIDogJ3NpdHVwJztcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKVxuICAgICAgICAgIGlmIChyZXN1bHRbc3BlY2lhbFNjb3JlXSkge1xuICAgICAgICAgICAgaWYgKGNvbmZpZ1tzcGVjaWFsU2NvcmVdW2ldICE9PSAnJyAmJiByZXN1bHRbc3BlY2lhbFNjb3JlXSAmJiByZXN1bHRbc3BlY2lhbFNjb3JlXSA8PSBjb25maWdbc3BlY2lhbFNjb3JlXVtpXSkge1xuICAgICAgICAgICAgICBQRXNjb3JlLnNwZWNpYWwgPSBoYXNoW2ldO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gbGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgUEVzY29yZS5zcGVjaWFsID0gaGFzaFtpXTtcbiAgICAgICAgICB9IGVsc2UgUEVzY29yZS5zcGVjaWFsID0gMDtcblxuICAgICAgICAvLyBUT0RPOuiuoeeul+WKoOWIhlxuXG5cbiAgICAgICAgLy8g6K6h566X5pyA57uI5oiQ57upXG4gICAgICAgIGNvbnN0IGZpbmFsU2NvcmUgPSBNYXRoLnJvdW5kKFBFc2NvcmUudml0YWxDYXBhY2l0eSAqIDE1ICsgUEVzY29yZS5zaG9ydFJ1biAqIDIwICsgUEVzY29yZS5zaXRBbmRSZWFjaCAqIDEwICtcbiAgICAgICAgICBQRXNjb3JlLnN0YW5kaW5nTG9uZ0p1bXAgKiAxMCArIFBFc2NvcmUuc3BlY2lhbCAqIDEwICsgUEVzY29yZS5sb25nUnVuICogMjAgK1xuICAgICAgICAgIFBFc2NvcmUuQk1JICogMTUpIC8gMTAwO1xuXG4gICAgICAgIGNvbnNvbGUuaW5mbygn5oiQ57up5Li6JywgUEVzY29yZSk7XG4gICAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgIHNob3dTY29yZTogdHJ1ZSxcbiAgICAgICAgICBQRXNjb3JlLFxuICAgICAgICAgIFBFOiB7XG4gICAgICAgICAgICBzY29yZTogZmluYWxTY29yZSxcbiAgICAgICAgICAgIHN0YXRlOiBmaW5hbFNjb3JlID49IFBFc2NvcmUucGFzc1Njb3JlID8gJ+WPiuagvCcgOiAn5LiN5Y+K5qC8J1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHd4LmhpZGVMb2FkaW5nKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHd4LmhpZGVMb2FkaW5nKCk7XG4gICAgICB3eC5zaG93VG9hc3QoeyB0aXRsZTogJ+ivt+mAieaLqeaAp+WIq+W5tOe6pycsIGljb246ICdub25lJywgZHVyYXRpb246IDI1MDAsIGltYWdlOiAnL2ljb24vY2xvc2UucG5nJyB9KTtcbiAgICB9XG4gIH0sXG4gIG5hdmlnYXRlKCkge1xuICAgIHRoaXMuJHJvdXRlKCcvbW9kdWxlL21vZHVsZTE/RnJvbT3kvZPmtYvorqHnrpflmagmYWltPXRlc3QwJmRlcHRoPTEnKTtcbiAgfSxcblxuICByZWRpcmVjdCgpIHtcbiAgICB0aGlzLiRsYXVuY2goJy9wYWdlL21haW4nKTtcbiAgfSxcbiAgb25TaGFyZUFwcE1lc3NhZ2U6ICgpID0+ICh7IHRpdGxlOiAn5L2T5rWL6K6h566X5ZmoJywgcGF0aDogJy9mdW5jdGlvbi9QRWNhbD9zaGFyZT10cnVlJyB9KVxufSk7XG4iXX0=