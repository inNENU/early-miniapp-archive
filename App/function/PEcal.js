"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var wxpage_1 = require("wxpage");
var component_1 = require("../utils/component");
var file_1 = require("../utils/file");
var page_1 = require("../utils/page");
var a = getApp().globalData;
var special = [
    { text: '引体向上', unit: '个', type: 'number', id: 'chinning' },
    { text: '仰卧起坐', unit: '个', type: 'number', id: 'situp' }
];
var longRunText = ['1000米跑', '800米跑'];
var longRunPicker = [['2分', '3分', '4分', '5分', '6分', '7分'], []];
for (var i = 0; i < 60; i++)
    longRunPicker[1].push(i + "\u79D2");
wxpage_1.default('PEcal', {
    data: {
        T: a.T,
        nm: a.nm,
        page: [{ tag: 'head', title: '体测计算器', grey: true, leftText: '功能大厅' }],
        gender: {
            picker: ['男', '女'],
            value: ['male', 'female']
        },
        grade: {
            picker: ['大一', '大二', '大三', '大四'],
            value: ['Low', 'Low', 'High', 'High']
        },
        list: [
            { text: '身高', unit: '厘米', type: 'number', id: 'height' },
            { text: '体重', unit: '千克', type: 'digit', id: 'weight' },
            { text: '坐位体前屈', unit: '厘米', type: 'digit', id: 'sitAndReach' },
            { text: '肺活量', unit: '毫升', type: 'number', id: 'vitalCapacity' },
            { text: '立定跳远', unit: '米', type: 'digit', id: 'standingLongJump' },
            { text: '50米跑', unit: '秒', type: 'digit', id: 'shortRun' }
        ],
        longRun: { text: '800米跑' },
        special: { text: '仰卧起坐', unit: '个', id: 'situp' },
        PEscore: {},
        result: {},
        scoreList: [
            { text: 'BMI', id: 'BMI' },
            { text: '坐位体前屈', id: 'sitAndReach' },
            { text: '肺活量', id: 'vitalCapacity' },
            { text: '立定跳远', id: 'standingLongJump' },
            { text: '50米跑', id: 'shortRun' }
        ]
    },
    onLoad: function (option) {
        page_1.default.Set({ option: option, ctx: this }, this.data.page);
        var genderIndex = wx.getStorageSync('gender');
        var gradeIndex = wx.getStorageSync('grade');
        if (genderIndex || genderIndex === 0)
            this.setData({
                'gender.index': genderIndex,
                'longRun.text': genderIndex === 0 ? longRunText[0] : longRunText[1],
                special: genderIndex === 0 ? special[0] : special[1],
                'result.gender': this.data.gender.value[genderIndex]
            });
        if (gradeIndex || gradeIndex === 0)
            this.setData({
                'grade.index': gradeIndex,
                'result.grade': this.data.grade.value[gradeIndex]
            });
        this.setData({ 'longRun.picker': longRunPicker });
        var _a = page_1.default.color(true), nc = _a.nc, bc = _a.bc;
        wx.setNavigationBarColor(nc);
        wx.setBackgroundColor(bc);
        page_1.default.Notice('PEcal');
    },
    onPageScroll: function (e) {
        component_1.default.nav(e, this);
    },
    cA: function (e) {
        component_1.default.trigger(e, this);
    },
    genderChange: function (event) {
        var index = Number(event.detail.value);
        var gender = this.data.gender.value[index];
        wx.setStorageSync('gender', index);
        this.setData({
            'result.gender': gender,
            'gender.index': index,
            special: gender === 'male' ? special[0] : special[1],
            'longRun.text': gender === 'male' ? longRunText[0] : longRunText[1]
        });
    },
    gradeChange: function (event) {
        var index = Number(event.detail.value);
        this.setData({
            'grade.index': index,
            'result.grade': this.data.grade.value[index]
        });
        wx.setStorageSync('grade', index);
    },
    focus: function (event) {
        console.log('focus', event);
        var id = event.currentTarget.id;
        var query = wx.createSelectorQuery();
        this.setData({ input: { status: true, height: event.detail.height } });
        query.select("#" + id)
            .boundingClientRect();
        query.selectViewport().fields({ size: true, scrollOffset: true });
        query.exec(function (res) {
            console.log(res);
            console.log('bottom是', res[0].bottom);
            console.log('scrollTop是', res[1].scrollTop);
            console.log('键盘高度是', event.detail.height);
            console.log('屏幕高度为', res[1].height);
            console.log(res[0].bottom + event.detail.height > res[1].height);
            if (res[0].bottom + event.detail.height > res[1].height) {
                console.log('scroll');
                console.log('计划向上滚动', res[0].bottom + event.detail.height - res[1].height + 10);
                console.log('新的应为', res[1].scrollTop + res[0].bottom + event.detail.height - res[1].height + 10);
                wx.pageScrollTo({ scrollTop: res[1].scrollTop + res[0].bottom + event.detail.height - res[1].height + 10 });
            }
        });
    },
    input: function (event) {
        var _a;
        console.log(event);
        var project = event.currentTarget.id;
        this.setData((_a = {}, _a["result." + project] = event.detail.value, _a));
    },
    blur: function () {
        this.setData({ 'input.status': false });
    },
    longRunHandler: function (event) {
        var value = event.detail.value;
        this.setData({
            'longRun.value': longRunPicker[0][value[0]] + " " + longRunPicker[1][value[1]],
            'result.longRun': (value[0] + 2) * 60 + value[1]
        });
    },
    calculate: function () {
        var _a;
        var _this = this;
        var result = this.data.result;
        wx.showLoading({ title: '计算中...', mask: true });
        console.info('输入结果为：', result);
        if (result.gender && result.grade) {
            var hash_1 = [10, 20, 30, 40, 50, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 85, 90, 95, 100];
            var length_1 = hash_1.length;
            var PEscore_1 = {
                BMI: 0,
                vitalCapacity: 0,
                sitAndReach: 0,
                standingLongJump: 0,
                shortRun: 0,
                longRun: 0,
                special: 0,
                passScore: 60
            };
            if (result.height && result.weight) {
                var state = void 0;
                var score = Math.round(result.weight * 100000 / result.height / result.height) / 10;
                _a = result.gender === 'male'
                    ? score <= 17.8 ? ['低体重', 80] : score >= 28.0 ? ['肥胖', 60] : score >= 24.0 ? ['超重', 80] : ['正常', 100]
                    : score <= 17.1 ? ['低体重', 80] : score >= 28.0 ? ['肥胖', 60] : score >= 24.0 ? ['超重', 80] : ['正常', 100], state = _a[0], PEscore_1.BMI = _a[1];
                PEscore_1.passScore = result.grade === 'Low'
                    ? score <= 28 ? 60 : 60 - Math.ceil(score - 28) * 2
                    : 50;
                this.setData({ BMI: { score: score, state: state } });
            }
            file_1.default.getJson("function/PEcal/" + result.gender + result.grade, function (config) {
                config.longRun = config.longRun.map(function (element) {
                    var time = element.split('-');
                    return Number(time[0]) * 60 + Number(time[1]);
                });
                config.standingLongJump = config.standingLongJump.map(function (element) { return element / 100; });
                console.log(config);
                ['vitalCapacity', 'sitAndReach', 'standingLongJump'].forEach(function (x) {
                    if (result[x]) {
                        for (var i = 0; i < length_1; i++)
                            if (result[x] <= config[x][i]) {
                                PEscore_1[x] = hash_1[i];
                                break;
                            }
                            else if (i === length_1 - 1)
                                PEscore_1[x] = hash_1[i];
                    }
                    else
                        PEscore_1[x] = 0;
                });
                ['shortRun', 'longRun'].forEach(function (x) {
                    if (result[x]) {
                        for (var i = 0; i < length_1; i++)
                            if (result[x] >= config[x][i]) {
                                PEscore_1[x] = hash_1[i];
                                break;
                            }
                            else if (i === length_1 - 1)
                                PEscore_1[x] = hash_1[i];
                    }
                    else
                        PEscore_1[x] = 0;
                });
                var specialScore = result.gender === 'male' ? 'chinning' : 'situp';
                for (var i = 0; i < length_1; i++)
                    if (result[specialScore]) {
                        if (config[specialScore][i] !== '' && result[specialScore] && result[specialScore] <= config[specialScore][i]) {
                            PEscore_1.special = hash_1[i];
                            break;
                        }
                        else if (i === length_1 - 1)
                            PEscore_1.special = hash_1[i];
                    }
                    else
                        PEscore_1.special = 0;
                var finalScore = Math.round(PEscore_1.vitalCapacity * 15 + PEscore_1.shortRun * 20 + PEscore_1.sitAndReach * 10 +
                    PEscore_1.standingLongJump * 10 + PEscore_1.special * 10 + PEscore_1.longRun * 20 +
                    PEscore_1.BMI * 15) / 100;
                console.info('成绩为', PEscore_1);
                _this.setData({
                    showScore: true,
                    PEscore: PEscore_1,
                    PE: {
                        score: finalScore,
                        state: finalScore >= PEscore_1.passScore ? '及格' : '不及格'
                    }
                });
            });
            wx.hideLoading();
        }
        else {
            wx.hideLoading();
            wx.showToast({ title: '请选择性别年级', icon: 'none', duration: 2500, image: '/icon/close.png' });
        }
    },
    navigate: function () {
        this.$route('/module/module1?From=体测计算器&aim=test0&depth=1');
    },
    redirect: function () {
        this.$launch('/page/main');
    },
    onShareAppMessage: function () { return ({ title: '体测计算器', path: '/function/PEcal?share=true' }); }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUEVjYWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJQRWNhbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQU9BLGlDQUErQjtBQUMvQixnREFBNEM7QUFDNUMsc0NBQWtDO0FBQ2xDLHNDQUFrQztBQUMxQixJQUFBLHVCQUFhLENBQWM7QUFFbkMsSUFBTSxPQUFPLEdBQUc7SUFDZCxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxVQUFVLEVBQUU7SUFDM0QsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFO0NBQ3pELENBQUM7QUFDRixJQUFNLFdBQVcsR0FBRyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUN4QyxJQUFNLGFBQWEsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztBQUVqRSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRTtJQUFFLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUksQ0FBQyxXQUFHLENBQUMsQ0FBQztBQUU1RCxnQkFBUyxDQUFDLE9BQU8sRUFBRTtJQUNqQixJQUFJLEVBQUU7UUFDSixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDTixFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUU7UUFDUixJQUFJLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsQ0FBQztRQUNyRSxNQUFNLEVBQUU7WUFD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LENBQUM7Z0JBRTFCLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLFNBQU8sQ0FBQyxDQUFDO2dCQUM3QixLQUFJLENBQUMsT0FBUSxDQUFDO29CQUNaLFNBQVMsRUFBRSxJQUFJO29CQUNmLE9BQU8sV0FBQTtvQkFDUCxFQUFFLEVBQUU7d0JBQ0YsS0FBSyxFQUFFLFVBQVU7d0JBQ2pCLEtBQUssRUFBRSxVQUFVLElBQUksU0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLO3FCQUN0RDtpQkFDRixDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztZQUNILEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNsQjthQUFNO1lBQ0wsRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2pCLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO1NBQzVGO0lBQ0gsQ0FBQztJQUNELFFBQVE7UUFDTixJQUFJLENBQUMsTUFBTSxDQUFDLDhDQUE4QyxDQUFDLENBQUM7SUFDOUQsQ0FBQztJQUVELFFBQVE7UUFDTixJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFDRCxpQkFBaUIsRUFBRSxjQUFNLE9BQUEsQ0FBQyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLDRCQUE0QixFQUFFLENBQUMsRUFBeEQsQ0FBd0Q7Q0FDbEYsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIEBBdXRob3I6IE1yLkhvcGVcbiAqIEBEYXRlOiAyMDE5LTA2LTI0IDIxOjE0OjExXG4gKiBATGFzdEVkaXRvcnM6IE1yLkhvcGVcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMDYtMjUgMTk6MzM6MDRcbiAqIEBEZXNjcmlwdGlvbjog5L2T5rWL6K6h566X5ZmoXG4gKi9cbmltcG9ydCAkcmVnaXN0ZXIgZnJvbSAnd3hwYWdlJztcbmltcG9ydCAkY29tcG9uZW50IGZyb20gJy4uL3V0aWxzL2NvbXBvbmVudCc7XG5pbXBvcnQgJGZpbGUgZnJvbSAnLi4vdXRpbHMvZmlsZSc7XG5pbXBvcnQgJHBhZ2UgZnJvbSAnLi4vdXRpbHMvcGFnZSc7XG5jb25zdCB7IGdsb2JhbERhdGE6IGEgfSA9IGdldEFwcCgpO1xuXG5jb25zdCBzcGVjaWFsID0gW1xuICB7IHRleHQ6ICflvJXkvZPlkJHkuIonLCB1bml0OiAn5LiqJywgdHlwZTogJ251bWJlcicsIGlkOiAnY2hpbm5pbmcnIH0sXG4gIHsgdGV4dDogJ+S7sOWNp+i1t+WdkCcsIHVuaXQ6ICfkuKonLCB0eXBlOiAnbnVtYmVyJywgaWQ6ICdzaXR1cCcgfVxuXTtcbmNvbnN0IGxvbmdSdW5UZXh0ID0gWycxMDAw57Gz6LeRJywgJzgwMOexs+i3kSddO1xuY29uc3QgbG9uZ1J1blBpY2tlciA9IFtbJzLliIYnLCAnM+WIhicsICc05YiGJywgJzXliIYnLCAnNuWIhicsICc35YiGJ10sIFtdXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCA2MDsgaSsrKSBsb25nUnVuUGlja2VyWzFdLnB1c2goYCR7aX3np5JgKTtcblxuJHJlZ2lzdGVyKCdQRWNhbCcsIHtcbiAgZGF0YToge1xuICAgIFQ6IGEuVCxcbiAgICBubTogYS5ubSxcbiAgICBwYWdlOiBbeyB0YWc6ICdoZWFkJywgdGl0bGU6ICfkvZPmtYvorqHnrpflmagnLCBncmV5OiB0cnVlLCBsZWZ0VGV4dDogJ+WKn+iDveWkp+WOhScgfV0sXG4gICAgZ2VuZGVyOiB7XG4gICAgICBwaWNrZXI6IFsn55S3JywgJ+WlsyddLFxuICAgICAgdmFsdWU6IFsnbWFsZScsICdmZW1hbGUnXVxuICAgIH0sXG4gICAgZ3JhZGU6IHtcbiAgICAgIHBpY2tlcjogWyflpKfkuIAnLCAn5aSn5LqMJywgJ+Wkp+S4iScsICflpKflm5snXSxcbiAgICAgIHZhbHVlOiBbJ0xvdycsICdMb3cnLCAnSGlnaCcsICdIaWdoJ11cbiAgICB9LFxuICAgIGxpc3Q6IFtcbiAgICAgIHsgdGV4dDogJ+i6q+mrmCcsIHVuaXQ6ICfljpjnsbMnLCB0eXBlOiAnbnVtYmVyJywgaWQ6ICdoZWlnaHQnIH0sXG4gICAgICB7IHRleHQ6ICfkvZPph40nLCB1bml0OiAn5Y2D5YWLJywgdHlwZTogJ2RpZ2l0JywgaWQ6ICd3ZWlnaHQnIH0sXG4gICAgICB7IHRleHQ6ICflnZDkvY3kvZPliY3lsYgnLCB1bml0OiAn5Y6Y57GzJywgdHlwZTogJ2RpZ2l0JywgaWQ6ICdzaXRBbmRSZWFjaCcgfSxcbiAgICAgIHsgdGV4dDogJ+iCuua0u+mHjycsIHVuaXQ6ICfmr6vljYcnLCB0eXBlOiAnbnVtYmVyJywgaWQ6ICd2aXRhbENhcGFjaXR5JyB9LFxuICAgICAgeyB0ZXh0OiAn56uL5a6a6Lez6L+cJywgdW5pdDogJ+exsycsIHR5cGU6ICdkaWdpdCcsIGlkOiAnc3RhbmRpbmdMb25nSnVtcCcgfSxcbiAgICAgIHsgdGV4dDogJzUw57Gz6LeRJywgdW5pdDogJ+enkicsIHR5cGU6ICdkaWdpdCcsIGlkOiAnc2hvcnRSdW4nIH1cbiAgICBdLFxuICAgIGxvbmdSdW46IHsgdGV4dDogJzgwMOexs+i3kScgfSxcbiAgICBzcGVjaWFsOiB7IHRleHQ6ICfku7DljafotbflnZAnLCB1bml0OiAn5LiqJywgaWQ6ICdzaXR1cCcgfSxcbiAgICBQRXNjb3JlOiB7fSxcbiAgICByZXN1bHQ6IHt9LFxuICAgIHNjb3JlTGlzdDogW1xuICAgICAgeyB0ZXh0OiAnQk1JJywgaWQ6ICdCTUknIH0sXG4gICAgICB7IHRleHQ6ICflnZDkvY3kvZPliY3lsYgnLCBpZDogJ3NpdEFuZFJlYWNoJyB9LFxuICAgICAgeyB0ZXh0OiAn6IK65rS76YePJywgaWQ6ICd2aXRhbENhcGFjaXR5JyB9LFxuICAgICAgeyB0ZXh0OiAn56uL5a6a6Lez6L+cJywgaWQ6ICdzdGFuZGluZ0xvbmdKdW1wJyB9LFxuICAgICAgeyB0ZXh0OiAnNTDnsbPot5EnLCBpZDogJ3Nob3J0UnVuJyB9XG4gICAgXVxuICB9LFxuICBvbkxvYWQob3B0aW9uOiBhbnkpIHtcbiAgICAkcGFnZS5TZXQoeyBvcHRpb24sIGN0eDogdGhpcyB9LCB0aGlzLmRhdGEucGFnZSk7XG4gICAgY29uc3QgZ2VuZGVySW5kZXggPSB3eC5nZXRTdG9yYWdlU3luYygnZ2VuZGVyJyk7XG4gICAgY29uc3QgZ3JhZGVJbmRleCA9IHd4LmdldFN0b3JhZ2VTeW5jKCdncmFkZScpO1xuXG4gICAgLy8g5bCG55So5oi35LiK5qyh6YCJ5oup55qE5oCn5Yir5ZKM5bm057qn6L295YWlXG4gICAgaWYgKGdlbmRlckluZGV4IHx8IGdlbmRlckluZGV4ID09PSAwKSAgLy8g5pS55Y+Y54m55Yir6aG555uu5ZKM6ZW/6LeR55qE5ZCN56ewXG4gICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgJ2dlbmRlci5pbmRleCc6IGdlbmRlckluZGV4LFxuICAgICAgICAnbG9uZ1J1bi50ZXh0JzogZ2VuZGVySW5kZXggPT09IDAgPyBsb25nUnVuVGV4dFswXSA6IGxvbmdSdW5UZXh0WzFdLFxuICAgICAgICBzcGVjaWFsOiBnZW5kZXJJbmRleCA9PT0gMCA/IHNwZWNpYWxbMF0gOiBzcGVjaWFsWzFdLFxuICAgICAgICAncmVzdWx0LmdlbmRlcic6IHRoaXMuZGF0YS5nZW5kZXIudmFsdWVbZ2VuZGVySW5kZXhdXG4gICAgICB9KTtcblxuICAgIGlmIChncmFkZUluZGV4IHx8IGdyYWRlSW5kZXggPT09IDApIC8vIOWGmeWFpeW5tOe6p1xuICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgICdncmFkZS5pbmRleCc6IGdyYWRlSW5kZXgsXG4gICAgICAgICdyZXN1bHQuZ3JhZGUnOiB0aGlzLmRhdGEuZ3JhZGUudmFsdWVbZ3JhZGVJbmRleF1cbiAgICAgIH0pO1xuXG4gICAgLy8g6K6+572u6ZW/6LeR6YCJ5oup5Zmo5pWw5o2uXG4gICAgdGhpcy5zZXREYXRhISh7ICdsb25nUnVuLnBpY2tlcic6IGxvbmdSdW5QaWNrZXIgfSk7XG5cbiAgICAvLyDorr7nva7og7blm4rlkozog4zmma/popzoibJcbiAgICBjb25zdCB7IG5jLCBiYyB9ID0gJHBhZ2UuY29sb3IodHJ1ZSk7XG5cbiAgICB3eC5zZXROYXZpZ2F0aW9uQmFyQ29sb3IobmMpO1xuICAgIHd4LnNldEJhY2tncm91bmRDb2xvcihiYyk7XG5cbiAgICAvLyDorr7nva7pgJrnn6VcbiAgICAkcGFnZS5Ob3RpY2UoJ1BFY2FsJyk7XG4gIH0sXG4gIG9uUGFnZVNjcm9sbChlOiBhbnkpIHtcbiAgICAkY29tcG9uZW50Lm5hdihlLCB0aGlzKTtcbiAgfSxcbiAgY0EoZTogYW55KSB7XG4gICAgJGNvbXBvbmVudC50cmlnZ2VyKGUsIHRoaXMpO1xuICB9LFxuICBnZW5kZXJDaGFuZ2UoZXZlbnQ6IGFueSkge1xuICAgIGNvbnN0IGluZGV4ID0gTnVtYmVyKGV2ZW50LmRldGFpbC52YWx1ZSk7XG4gICAgY29uc3QgZ2VuZGVyID0gdGhpcy5kYXRhLmdlbmRlci52YWx1ZVtpbmRleF07XG5cbiAgICB3eC5zZXRTdG9yYWdlU3luYygnZ2VuZGVyJywgaW5kZXgpO1xuXG4gICAgLy8g5pS55Y+Y54m55Yir6aG555uu5ZKM6ZW/6LeR55qE5ZCN56ewXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAncmVzdWx0LmdlbmRlcic6IGdlbmRlcixcbiAgICAgICdnZW5kZXIuaW5kZXgnOiBpbmRleCxcbiAgICAgIHNwZWNpYWw6IGdlbmRlciA9PT0gJ21hbGUnID8gc3BlY2lhbFswXSA6IHNwZWNpYWxbMV0sXG4gICAgICAnbG9uZ1J1bi50ZXh0JzogZ2VuZGVyID09PSAnbWFsZScgPyBsb25nUnVuVGV4dFswXSA6IGxvbmdSdW5UZXh0WzFdXG4gICAgfSk7XG4gIH0sXG4gIGdyYWRlQ2hhbmdlKGV2ZW50OiBhbnkpIHtcbiAgICBjb25zdCBpbmRleCA9IE51bWJlcihldmVudC5kZXRhaWwudmFsdWUpO1xuXG4gICAgLy8g6K6+572u5bm057qnXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAnZ3JhZGUuaW5kZXgnOiBpbmRleCxcbiAgICAgICdyZXN1bHQuZ3JhZGUnOiB0aGlzLmRhdGEuZ3JhZGUudmFsdWVbaW5kZXhdXG4gICAgfSk7XG4gICAgd3guc2V0U3RvcmFnZVN5bmMoJ2dyYWRlJywgaW5kZXgpO1xuICB9LFxuICBmb2N1cyhldmVudDogYW55KSB7XG4gICAgY29uc29sZS5sb2coJ2ZvY3VzJywgZXZlbnQpO1xuICAgIGNvbnN0IHsgaWQgfSA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgY29uc3QgcXVlcnkgPSB3eC5jcmVhdGVTZWxlY3RvclF1ZXJ5KCk7XG5cbiAgICB0aGlzLnNldERhdGEhKHsgaW5wdXQ6IHsgc3RhdHVzOiB0cnVlLCBoZWlnaHQ6IGV2ZW50LmRldGFpbC5oZWlnaHQgfSB9KTtcblxuICAgIHF1ZXJ5LnNlbGVjdChgIyR7aWR9YClcbiAgICAgIC5ib3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBxdWVyeS5zZWxlY3RWaWV3cG9ydCgpLmZpZWxkcyh7IHNpemU6IHRydWUsIHNjcm9sbE9mZnNldDogdHJ1ZSB9KTtcbiAgICBxdWVyeS5leGVjKChyZXM6IGFueSkgPT4ge1xuICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgIGNvbnNvbGUubG9nKCdib3R0b23mmK8nLCByZXNbMF0uYm90dG9tKTtcbiAgICAgIGNvbnNvbGUubG9nKCdzY3JvbGxUb3DmmK8nLCByZXNbMV0uc2Nyb2xsVG9wKTtcbiAgICAgIGNvbnNvbGUubG9nKCfplK7nm5jpq5jluqbmmK8nLCBldmVudC5kZXRhaWwuaGVpZ2h0KTtcbiAgICAgIGNvbnNvbGUubG9nKCflsY/luZXpq5jluqbkuLonLCByZXNbMV0uaGVpZ2h0KTtcbiAgICAgIGNvbnNvbGUubG9nKHJlc1swXS5ib3R0b20gKyBldmVudC5kZXRhaWwuaGVpZ2h0ID4gcmVzWzFdLmhlaWdodCk7XG4gICAgICBpZiAocmVzWzBdLmJvdHRvbSArIGV2ZW50LmRldGFpbC5oZWlnaHQgPiByZXNbMV0uaGVpZ2h0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzY3JvbGwnKTtcbiAgICAgICAgY29uc29sZS5sb2coJ+iuoeWIkuWQkeS4iua7muWKqCcsIHJlc1swXS5ib3R0b20gKyBldmVudC5kZXRhaWwuaGVpZ2h0IC0gcmVzWzFdLmhlaWdodCArIDEwKTtcbiAgICAgICAgY29uc29sZS5sb2coJ+aWsOeahOW6lOS4uicsIHJlc1sxXS5zY3JvbGxUb3AgKyByZXNbMF0uYm90dG9tICsgZXZlbnQuZGV0YWlsLmhlaWdodCAtIHJlc1sxXS5oZWlnaHQgKyAxMCk7XG4gICAgICAgIHd4LnBhZ2VTY3JvbGxUbyh7IHNjcm9sbFRvcDogcmVzWzFdLnNjcm9sbFRvcCArIHJlc1swXS5ib3R0b20gKyBldmVudC5kZXRhaWwuaGVpZ2h0IC0gcmVzWzFdLmhlaWdodCArIDEwIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuICBpbnB1dChldmVudDogYW55KSB7XG4gICAgY29uc29sZS5sb2coZXZlbnQpO1xuICAgIGNvbnN0IHByb2plY3QgPSBldmVudC5jdXJyZW50VGFyZ2V0LmlkO1xuXG4gICAgdGhpcy5zZXREYXRhISh7IFtgcmVzdWx0LiR7cHJvamVjdH1gXTogZXZlbnQuZGV0YWlsLnZhbHVlIH0pO1xuICB9LFxuICBibHVyKCkge1xuICAgIHRoaXMuc2V0RGF0YSEoeyAnaW5wdXQuc3RhdHVzJzogZmFsc2UgfSk7XG4gIH0sXG4gIGxvbmdSdW5IYW5kbGVyKGV2ZW50OiBhbnkpIHtcbiAgICBjb25zdCB7IHZhbHVlIH0gPSBldmVudC5kZXRhaWw7XG5cbiAgICAvLyDorr7nva7mmL7npLrmlbDmja5cbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICdsb25nUnVuLnZhbHVlJzogYCR7bG9uZ1J1blBpY2tlclswXVt2YWx1ZVswXV19ICR7bG9uZ1J1blBpY2tlclsxXVt2YWx1ZVsxXV19YCxcbiAgICAgICdyZXN1bHQubG9uZ1J1bic6ICh2YWx1ZVswXSArIDIpICogNjAgKyB2YWx1ZVsxXVxuICAgIH0pO1xuXG5cbiAgfSxcbiAgY2FsY3VsYXRlKCkge1xuICAgIGNvbnN0IHsgcmVzdWx0IH0gPSB0aGlzLmRhdGE7XG5cbiAgICB3eC5zaG93TG9hZGluZyh7IHRpdGxlOiAn6K6h566X5LitLi4uJywgbWFzazogdHJ1ZSB9KTtcbiAgICBjb25zb2xlLmluZm8oJ+i+k+WFpee7k+aenOS4uu+8micsIHJlc3VsdCk7XG5cbiAgICBpZiAocmVzdWx0LmdlbmRlciAmJiByZXN1bHQuZ3JhZGUpIHsgLy8g5Y+v5Lul6K6h566XXG4gICAgICBpbnRlcmZhY2UgUEVTY29yZSB7XG4gICAgICAgIEJNSTogbnVtYmVyLFxuICAgICAgICB2aXRhbENhcGFjaXR5OiBudW1iZXIsXG4gICAgICAgIHNpdEFuZFJlYWNoOiBudW1iZXIsXG4gICAgICAgIHN0YW5kaW5nTG9uZ0p1bXA6IG51bWJlcixcbiAgICAgICAgc2hvcnRSdW46IG51bWJlcixcbiAgICAgICAgbG9uZ1J1bjogbnVtYmVyLFxuICAgICAgICBzcGVjaWFsOiBudW1iZXI7XG4gICAgICAgIHBhc3NTY29yZTogbnVtYmVyO1xuICAgICAgICBbcHJvcHM6IHN0cmluZ106IG51bWJlcjtcbiAgICAgIH1cblxuXG4gICAgICBjb25zdCBoYXNoID0gWzEwLCAyMCwgMzAsIDQwLCA1MCwgNjAsIDYyLCA2NCwgNjYsIDY4LCA3MCwgNzIsIDc0LCA3NiwgNzgsIDgwLCA4NSwgOTAsIDk1LCAxMDBdO1xuICAgICAgY29uc3QgeyBsZW5ndGggfSA9IGhhc2g7XG4gICAgICBjb25zdCBQRXNjb3JlOiBQRVNjb3JlID0ge1xuICAgICAgICBCTUk6IDAsXG4gICAgICAgIHZpdGFsQ2FwYWNpdHk6IDAsXG4gICAgICAgIHNpdEFuZFJlYWNoOiAwLFxuICAgICAgICBzdGFuZGluZ0xvbmdKdW1wOiAwLFxuICAgICAgICBzaG9ydFJ1bjogMCxcbiAgICAgICAgbG9uZ1J1bjogMCxcbiAgICAgICAgc3BlY2lhbDogMCxcbiAgICAgICAgcGFzc1Njb3JlOiA2MFxuICAgICAgfTtcblxuICAgICAgaWYgKHJlc3VsdC5oZWlnaHQgJiYgcmVzdWx0LndlaWdodCkgeyAvLyDlj6/ku6XorqHnrpdCTUlcbiAgICAgICAgbGV0IHN0YXRlO1xuICAgICAgICBjb25zdCBzY29yZSA9IE1hdGgucm91bmQocmVzdWx0LndlaWdodCAqIDEwMDAwMCAvIHJlc3VsdC5oZWlnaHQgLyByZXN1bHQuaGVpZ2h0KSAvIDEwO1xuXG4gICAgICAgIC8vIOiuoeeul0JNSeeKtuaAgeS4juWIhuWAvFxuICAgICAgICBbc3RhdGUsIFBFc2NvcmUuQk1JXSA9IHJlc3VsdC5nZW5kZXIgPT09ICdtYWxlJ1xuICAgICAgICAgID8gc2NvcmUgPD0gMTcuOCA/IFsn5L2O5L2T6YeNJywgODBdIDogc2NvcmUgPj0gMjguMCA/IFsn6IKl6IOWJywgNjBdIDogc2NvcmUgPj0gMjQuMCA/IFsn6LaF6YeNJywgODBdIDogWyfmraPluLgnLCAxMDBdXG4gICAgICAgICAgOiBzY29yZSA8PSAxNy4xID8gWyfkvY7kvZPph40nLCA4MF0gOiBzY29yZSA+PSAyOC4wID8gWyfogqXog5YnLCA2MF0gOiBzY29yZSA+PSAyNC4wID8gWyfotoXph40nLCA4MF0gOiBbJ+ato+W4uCcsIDEwMF07XG5cbiAgICAgICAgLy8g6K6h566X5Y+K5qC85YiG5pWwXG4gICAgICAgIFBFc2NvcmUucGFzc1Njb3JlID0gcmVzdWx0LmdyYWRlID09PSAnTG93J1xuICAgICAgICAgID8gc2NvcmUgPD0gMjggPyA2MCA6IDYwIC0gTWF0aC5jZWlsKHNjb3JlIC0gMjgpICogMlxuICAgICAgICAgIDogNTA7XG5cbiAgICAgICAgdGhpcy5zZXREYXRhISh7IEJNSTogeyBzY29yZSwgc3RhdGUgfSB9KTtcbiAgICAgIH1cblxuICAgICAgJGZpbGUuZ2V0SnNvbihgZnVuY3Rpb24vUEVjYWwvJHtyZXN1bHQuZ2VuZGVyfSR7cmVzdWx0LmdyYWRlfWAsIChjb25maWc6IGFueSkgPT4geyAvLyDor7vlj5bnm7jlupTphY3nva7mlofku7ZcblxuICAgICAgICAvLyDovazmjaLplb/ot5Hml7bpl7RcbiAgICAgICAgY29uZmlnLmxvbmdSdW4gPSBjb25maWcubG9uZ1J1bi5tYXAoKGVsZW1lbnQ6IHN0cmluZykgPT4ge1xuICAgICAgICAgIGNvbnN0IHRpbWUgPSBlbGVtZW50LnNwbGl0KCctJyk7XG5cbiAgICAgICAgICByZXR1cm4gTnVtYmVyKHRpbWVbMF0pICogNjAgKyBOdW1iZXIodGltZVsxXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIOi9rOaNoueri+Wumui3s+i/nOWNleS9jVxuICAgICAgICBjb25maWcuc3RhbmRpbmdMb25nSnVtcCA9IGNvbmZpZy5zdGFuZGluZ0xvbmdKdW1wLm1hcCgoZWxlbWVudDogbnVtYmVyKSA9PiBlbGVtZW50IC8gMTAwKTtcblxuICAgICAgICBjb25zb2xlLmxvZyhjb25maWcpO1xuXG4gICAgICAgIC8vIOS7peS4i+S4iemhuei2iumrmOi2iuWlve+8jOi/m+ihjOiuoeeul1xuICAgICAgICBbJ3ZpdGFsQ2FwYWNpdHknLCAnc2l0QW5kUmVhY2gnLCAnc3RhbmRpbmdMb25nSnVtcCddLmZvckVhY2goeCA9PiB7XG4gICAgICAgICAgaWYgKHJlc3VsdFt4XSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgaWYgKHJlc3VsdFt4XSA8PSBjb25maWdbeF1baV0pIHtcbiAgICAgICAgICAgICAgICBQRXNjb3JlW3hdID0gaGFzaFtpXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID09PSBsZW5ndGggLSAxKVxuICAgICAgICAgICAgICAgIFBFc2NvcmVbeF0gPSBoYXNoW2ldO1xuICAgICAgICAgIH0gZWxzZSBQRXNjb3JlW3hdID0gMDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8g5Lul5LiL5Lik6aG56LaK5L2O6LaK5aW9XG4gICAgICAgIFsnc2hvcnRSdW4nLCAnbG9uZ1J1biddLmZvckVhY2goeCA9PiB7XG4gICAgICAgICAgaWYgKHJlc3VsdFt4XSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgaWYgKHJlc3VsdFt4XSA+PSBjb25maWdbeF1baV0pIHtcbiAgICAgICAgICAgICAgICBQRXNjb3JlW3hdID0gaGFzaFtpXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID09PSBsZW5ndGggLSAxKVxuICAgICAgICAgICAgICAgIFBFc2NvcmVbeF0gPSBoYXNoW2ldO1xuICAgICAgICAgIH0gZWxzZSBQRXNjb3JlW3hdID0gMDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8g6K6h566X54m55Yir57G76aG555uu5YiG5pWwXG4gICAgICAgIGNvbnN0IHNwZWNpYWxTY29yZSA9IHJlc3VsdC5nZW5kZXIgPT09ICdtYWxlJyA/ICdjaGlubmluZycgOiAnc2l0dXAnO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXG4gICAgICAgICAgaWYgKHJlc3VsdFtzcGVjaWFsU2NvcmVdKSB7XG4gICAgICAgICAgICBpZiAoY29uZmlnW3NwZWNpYWxTY29yZV1baV0gIT09ICcnICYmIHJlc3VsdFtzcGVjaWFsU2NvcmVdICYmIHJlc3VsdFtzcGVjaWFsU2NvcmVdIDw9IGNvbmZpZ1tzcGVjaWFsU2NvcmVdW2ldKSB7XG4gICAgICAgICAgICAgIFBFc2NvcmUuc3BlY2lhbCA9IGhhc2hbaV07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpID09PSBsZW5ndGggLSAxKVxuICAgICAgICAgICAgICBQRXNjb3JlLnNwZWNpYWwgPSBoYXNoW2ldO1xuICAgICAgICAgIH0gZWxzZSBQRXNjb3JlLnNwZWNpYWwgPSAwO1xuXG4gICAgICAgIC8vIFRPRE866K6h566X5Yqg5YiGXG5cblxuICAgICAgICAvLyDorqHnrpfmnIDnu4jmiJDnu6lcbiAgICAgICAgY29uc3QgZmluYWxTY29yZSA9IE1hdGgucm91bmQoUEVzY29yZS52aXRhbENhcGFjaXR5ICogMTUgKyBQRXNjb3JlLnNob3J0UnVuICogMjAgKyBQRXNjb3JlLnNpdEFuZFJlYWNoICogMTAgK1xuICAgICAgICAgIFBFc2NvcmUuc3RhbmRpbmdMb25nSnVtcCAqIDEwICsgUEVzY29yZS5zcGVjaWFsICogMTAgKyBQRXNjb3JlLmxvbmdSdW4gKiAyMCArXG4gICAgICAgICAgUEVzY29yZS5CTUkgKiAxNSkgLyAxMDA7XG5cbiAgICAgICAgY29uc29sZS5pbmZvKCfmiJDnu6nkuLonLCBQRXNjb3JlKTtcbiAgICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgICAgc2hvd1Njb3JlOiB0cnVlLFxuICAgICAgICAgIFBFc2NvcmUsXG4gICAgICAgICAgUEU6IHtcbiAgICAgICAgICAgIHNjb3JlOiBmaW5hbFNjb3JlLFxuICAgICAgICAgICAgc3RhdGU6IGZpbmFsU2NvcmUgPj0gUEVzY29yZS5wYXNzU2NvcmUgPyAn5Y+K5qC8JyA6ICfkuI3lj4rmoLwnXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgd3guaGlkZUxvYWRpbmcoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd3guaGlkZUxvYWRpbmcoKTtcbiAgICAgIHd4LnNob3dUb2FzdCh7IHRpdGxlOiAn6K+36YCJ5oup5oCn5Yir5bm057qnJywgaWNvbjogJ25vbmUnLCBkdXJhdGlvbjogMjUwMCwgaW1hZ2U6ICcvaWNvbi9jbG9zZS5wbmcnIH0pO1xuICAgIH1cbiAgfSxcbiAgbmF2aWdhdGUoKSB7XG4gICAgdGhpcy4kcm91dGUoJy9tb2R1bGUvbW9kdWxlMT9Gcm9tPeS9k+a1i+iuoeeul+WZqCZhaW09dGVzdDAmZGVwdGg9MScpO1xuICB9LFxuXG4gIHJlZGlyZWN0KCkge1xuICAgIHRoaXMuJGxhdW5jaCgnL3BhZ2UvbWFpbicpO1xuICB9LFxuICBvblNoYXJlQXBwTWVzc2FnZTogKCkgPT4gKHsgdGl0bGU6ICfkvZPmtYvorqHnrpflmagnLCBwYXRoOiAnL2Z1bmN0aW9uL1BFY2FsP3NoYXJlPXRydWUnIH0pXG59KTtcbiJdfQ==