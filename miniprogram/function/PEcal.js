"use strict";
var _a = getApp(), a = _a.globalData, _b = _a.lib, $register = _b.$register, $page = _b.$page;
var special = [
    { text: '引体向上', unit: '个', type: 'number', id: 'chinning' },
    { text: '仰卧起坐', unit: '个', type: 'number', id: 'situp' }
];
var longRunText = ['1000米跑', '800米跑'];
var longRunPicker = [['2分', '3分', '4分', '5分', '6分', '7分'], []];
for (var i = 0; i < 60; i++)
    longRunPicker[1].push(i + "\u79D2");
$register('PEcal', {
    data: {
        T: a.T,
        nm: a.nm,
        page: [{ tag: 'head', title: '体测计算器', grey: true, leftText: '功能大厅' }],
        gender: {
            picker: ['男', '女'],
            value: ['male', 'female']
        },
        grade: {
            picker: ['大一', '大二', '大三', '大四'],
            value: ['Low', 'Low', 'High', 'High']
        },
        list: [
            { text: '身高', unit: '厘米', type: 'number', id: 'height' },
            { text: '体重', unit: '千克', type: 'digit', id: 'weight' },
            { text: '坐位体前屈', unit: '厘米', type: 'digit', id: 'sitAndReach' },
            { text: '肺活量', unit: '毫升', type: 'number', id: 'vitalCapacity' },
            { text: '立定跳远', unit: '米', type: 'digit', id: 'standingLongJump' },
            { text: '50米跑', unit: '秒', type: 'digit', id: 'shortRun' }
        ],
        longRun: { text: '800米跑' },
        special: { text: '仰卧起坐', unit: '个', id: 'situp' },
        PEscore: {},
        result: {},
        scoreList: [
            { text: 'BMI', id: 'BMI' },
            { text: '坐位体前屈', id: 'sitAndReach' },
            { text: '肺活量', id: 'vitalCapacity' },
            { text: '立定跳远', id: 'standingLongJump' },
            { text: '50米跑', id: 'shortRun' }
        ]
    },
    onLoad: function (option) {
        $page.Set({ option: option, ctx: this }, this.data.page);
        var genderIndex = wx.getStorageSync('gender');
        var gradeIndex = wx.getStorageSync('grade');
        if (genderIndex || genderIndex === 0)
            this.setData({
                'gender.index': genderIndex,
                'longRun.text': genderIndex === 0 ? longRunText[0] : longRunText[1],
                special: genderIndex === 0 ? special[0] : special[1],
                'result.gender': this.data.gender.value[genderIndex]
            });
        if (gradeIndex || gradeIndex === 0)
            this.setData({
                'grade.index': gradeIndex,
                'result.grade': this.data.grade.value[gradeIndex]
            });
        this.setData({ 'longRun.picker': longRunPicker });
        var _a = $page.color(true), nc = _a[0], bc = _a[1];
        wx.setNavigationBarColor(nc);
        wx.setBackgroundColor(bc);
        $page.Notice('PEcal');
    },
    onPageScroll: function (e) {
        $component.nav(e, this);
    },
    cA: function (e) {
        $component.trigger(e, this);
    },
    genderChange: function (event) {
        var index = Number(event.detail.value);
        var gender = this.data.gender.value[index];
        wx.setStorageSync('gender', index);
        this.setData({
            'result.gender': gender,
            'gender.index': index,
            special: gender === 'male' ? special[0] : special[1],
            'longRun.text': gender === 'male' ? longRunText[0] : longRunText[1]
        });
    },
    gradeChange: function (event) {
        var index = Number(event.detail.value);
        this.setData({
            'grade.index': index,
            'result.grade': this.data.grade.value[index]
        });
        wx.setStorageSync('grade', index);
    },
    focus: function (event) {
        console.log('focus', event);
        var id = event.currentTarget.id;
        var query = wx.createSelectorQuery();
        this.setData({ input: { status: true, height: event.detail.height } });
        query.select("#" + id)
            .boundingClientRect();
        query.selectViewport().fields({ size: true, scrollOffset: true });
        query.exec(function (res) {
            console.log(res);
            console.log('bottom是', res[0].bottom);
            console.log('scrollTop是', res[1].scrollTop);
            console.log('键盘高度是', event.detail.height);
            console.log('屏幕高度为', res[1].height);
            console.log(res[0].bottom + event.detail.height > res[1].height);
            if (res[0].bottom + event.detail.height > res[1].height) {
                console.log('scroll');
                console.log('计划向上滚动', res[0].bottom + event.detail.height - res[1].height + 10);
                console.log('新的应为', res[1].scrollTop + res[0].bottom + event.detail.height - res[1].height + 10);
                wx.pageScrollTo({ scrollTop: res[1].scrollTop + res[0].bottom + event.detail.height - res[1].height + 10 });
            }
        });
    },
    input: function (event) {
        var _a;
        console.log(event);
        var project = event.currentTarget.id;
        this.setData((_a = {}, _a["result." + project] = event.detail.value, _a));
    },
    blur: function () {
        this.setData({ 'input.status': false });
    },
    longRunHandler: function (event) {
        var value = event.detail.value;
        this.setData({
            'longRun.value': longRunPicker[0][value[0]] + " " + longRunPicker[1][value[1]],
            'result.longRun': (value[0] + 2) * 60 + value[1]
        });
    },
    calculate: function () {
        var _a;
        var _this = this;
        var result = this.data.result;
        wx.showLoading({ title: '计算中...', mask: true });
        console.info('输入结果为：', result);
        if (result.gender && result.grade) {
            var hash_1 = [10, 20, 30, 40, 50, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 85, 90, 95, 100];
            var length_1 = hash_1.length;
            var PEscore_1 = {
                BMI: 0,
                vitalCapacity: 0,
                sitAndReach: 0,
                standingLongJump: 0,
                shortRun: 0,
                longRun: 0,
                special: 0
            };
            if (result.height && result.weight) {
                var state = void 0;
                var score = Math.round(result.weight * 100000 / result.height / result.height) / 10;
                _a = result.gender === 'male'
                    ? score <= 17.8 ? ['低体重', 80] : score >= 28.0 ? ['肥胖', 60] : score >= 24.0 ? ['超重', 80] : ['正常', 100]
                    : score <= 17.1 ? ['低体重', 80] : score >= 28.0 ? ['肥胖', 60] : score >= 24.0 ? ['超重', 80] : ['正常', 100], state = _a[0], PEscore_1.BMI = _a[1];
                PEscore_1.passScore = result.grade === 'Low'
                    ? score <= 28 ? 60 : 60 - Math.ceil(score - 28) * 2
                    : 50;
                this.setData({ BMI: { score: score, state: state } });
            }
            $file.getJson("function/PEcal/" + result.gender + result.grade, function (config) {
                config.longRun = config.longRun.map(function (element) {
                    var time = element.split('-');
                    return Number(time[0]) * 60 + Number(time[1]);
                });
                config.standingLongJump = config.standingLongJump.map(function (element) { return element / 100; });
                console.log(config);
                ['vitalCapacity', 'sitAndReach', 'standingLongJump'].forEach(function (x) {
                    if (result[x]) {
                        for (var i = 0; i < length_1; i++)
                            if (result[x] <= config[x][i]) {
                                PEscore_1[x] = hash_1[i];
                                break;
                            }
                            else if (i === length_1 - 1)
                                PEscore_1[x] = hash_1[i];
                    }
                    else
                        PEscore_1[x] = 0;
                });
                ['shortRun', 'longRun'].forEach(function (x) {
                    if (result[x]) {
                        for (var i = 0; i < length_1; i++)
                            if (result[x] >= config[x][i]) {
                                PEscore_1[x] = hash_1[i];
                                break;
                            }
                            else if (i === length_1 - 1)
                                PEscore_1[x] = hash_1[i];
                    }
                    else
                        PEscore_1[x] = 0;
                });
                var specialScore = result.gender === 'male' ? 'chinning' : 'situp';
                for (var i = 0; i < length_1; i++)
                    if (result[specialScore]) {
                        if (config[specialScore][i] !== '' && result[specialScore] && result[specialScore] <= config[specialScore][i]) {
                            PEscore_1.special = hash_1[i];
                            break;
                        }
                        else if (i === length_1 - 1)
                            PEscore_1.special = hash_1[i];
                    }
                    else
                        PEscore_1.special = 0;
                var finalScore = (PEscore_1.vitalCapacity * 0.15 + PEscore_1.shortRun * 0.2 + PEscore_1.sitAndReach * 0.1 +
                    PEscore_1.standingLongJump * 0.1 + PEscore_1.special * 0.1 + PEscore_1.longRun * 0.2 +
                    PEscore_1.BMI * 0.15).toFixed(2);
                console.info('成绩为', PEscore_1);
                _this.setData({
                    showScore: true,
                    PEscore: PEscore_1,
                    PE: {
                        score: finalScore,
                        state: finalScore >= PEscore_1.passScore ? '及格' : '不及格'
                    }
                });
            });
            wx.hideLoading();
        }
        else {
            wx.hideLoading();
            wx.showToast({ title: '请选择性别年级', icon: 'none', duration: 2500, image: '/icon/close.png' });
        }
    },
    navigate: function () {
        this.$route('/module/module1?From=体测计算器&aim=test0&depth=1');
    },
    redirect: function () {
        this.$launch('/page/main');
    },
    onShareAppMessage: function () { return ({ title: '体测计算器', path: '/function/PEcal?share=true' }); }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUEVjYWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJQRWNhbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBUU0sSUFBQSxhQUF1RCxFQUFyRCxpQkFBYSxFQUFFLFdBQXlCLEVBQWxCLHdCQUFTLEVBQUUsZ0JBQW9CLENBQUM7QUFFOUQsSUFBTSxPQUFPLEdBQUc7SUFDZCxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxVQUFVLEVBQUU7SUFDM0QsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFO0NBQ3pELENBQUM7QUFDRixJQUFNLFdBQVcsR0FBRyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUN4QyxJQUFNLGFBQWEsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztBQUVqRSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRTtJQUFFLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUksQ0FBQyxXQUFHLENBQUMsQ0FBQztBQUU1RCxTQUFTLENBQUMsT0FBTyxFQUFFO0lBQ2pCLElBQUksRUFBRTtRQUNKLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNOLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRTtRQUNSLElBQUksRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxDQUFDO1FBQ3JFLE1BQU0sRUFBRTtZQUNOLE1BQU0s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SyxFQUFFLFNBQU8sQ0FBQyxDQUFDO2dCQUM3QixLQUFJLENBQUMsT0FBTyxDQUFDO29CQUNYLFNBQVMsRUFBRSxJQUFJO29CQUNmLE9BQU8sV0FBQTtvQkFDUCxFQUFFLEVBQUU7d0JBQ0YsS0FBSyxFQUFFLFVBQVU7d0JBQ2pCLEtBQUssRUFBRSxVQUFVLElBQUksU0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLO3FCQUN0RDtpQkFDRixDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztZQUNILEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNsQjthQUFNO1lBQ0wsRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2pCLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO1NBQzVGO0lBQ0gsQ0FBQztJQUNELFFBQVE7UUFDTixJQUFJLENBQUMsTUFBTSxDQUFDLDhDQUE4QyxDQUFDLENBQUM7SUFDOUQsQ0FBQztJQUVELFFBQVE7UUFDTixJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFDRCxpQkFBaUIsRUFBRSxjQUFNLE9BQUEsQ0FBQyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLDRCQUE0QixFQUFFLENBQUMsRUFBeEQsQ0FBd0Q7Q0FDbEYsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIEBBdXRob3I6IE1yLkhvcGVcbiAqIEBEYXRlOiAyMDE5LTA2LTI0IDIxOjE0OjExXG4gKiBATGFzdEVkaXRvcnM6IE1yLkhvcGVcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMDYtMjQgMjE6MTk6NDNcbiAqIEBEZXNjcmlwdGlvbjog5L2T5rWL6K6h566X5ZmoXG4gKi9cblxuY29uc3QgeyBnbG9iYWxEYXRhOiBhLCBsaWI6IHsgJHJlZ2lzdGVyLCAkcGFnZSB9IH0gPSBnZXRBcHAoKTtcblxuY29uc3Qgc3BlY2lhbCA9IFtcbiAgeyB0ZXh0OiAn5byV5L2T5ZCR5LiKJywgdW5pdDogJ+S4qicsIHR5cGU6ICdudW1iZXInLCBpZDogJ2NoaW5uaW5nJyB9LFxuICB7IHRleHQ6ICfku7DljafotbflnZAnLCB1bml0OiAn5LiqJywgdHlwZTogJ251bWJlcicsIGlkOiAnc2l0dXAnIH1cbl07XG5jb25zdCBsb25nUnVuVGV4dCA9IFsnMTAwMOexs+i3kScsICc4MDDnsbPot5EnXTtcbmNvbnN0IGxvbmdSdW5QaWNrZXIgPSBbWycy5YiGJywgJzPliIYnLCAnNOWIhicsICc15YiGJywgJzbliIYnLCAnN+WIhiddLCBbXV07XG5cbmZvciAobGV0IGkgPSAwOyBpIDwgNjA7IGkrKykgbG9uZ1J1blBpY2tlclsxXS5wdXNoKGAke2l956eSYCk7XG5cbiRyZWdpc3RlcignUEVjYWwnLCB7XG4gIGRhdGE6IHtcbiAgICBUOiBhLlQsXG4gICAgbm06IGEubm0sXG4gICAgcGFnZTogW3sgdGFnOiAnaGVhZCcsIHRpdGxlOiAn5L2T5rWL6K6h566X5ZmoJywgZ3JleTogdHJ1ZSwgbGVmdFRleHQ6ICflip/og73lpKfljoUnIH1dLFxuICAgIGdlbmRlcjoge1xuICAgICAgcGlja2VyOiBbJ+eUtycsICflpbMnXSxcbiAgICAgIHZhbHVlOiBbJ21hbGUnLCAnZmVtYWxlJ11cbiAgICB9LFxuICAgIGdyYWRlOiB7XG4gICAgICBwaWNrZXI6IFsn5aSn5LiAJywgJ+Wkp+S6jCcsICflpKfkuIknLCAn5aSn5ZubJ10sXG4gICAgICB2YWx1ZTogWydMb3cnLCAnTG93JywgJ0hpZ2gnLCAnSGlnaCddXG4gICAgfSxcbiAgICBsaXN0OiBbXG4gICAgICB7IHRleHQ6ICfouqvpq5gnLCB1bml0OiAn5Y6Y57GzJywgdHlwZTogJ251bWJlcicsIGlkOiAnaGVpZ2h0JyB9LFxuICAgICAgeyB0ZXh0OiAn5L2T6YeNJywgdW5pdDogJ+WNg+WFiycsIHR5cGU6ICdkaWdpdCcsIGlkOiAnd2VpZ2h0JyB9LFxuICAgICAgeyB0ZXh0OiAn5Z2Q5L2N5L2T5YmN5bGIJywgdW5pdDogJ+WOmOexsycsIHR5cGU6ICdkaWdpdCcsIGlkOiAnc2l0QW5kUmVhY2gnIH0sXG4gICAgICB7IHRleHQ6ICfogrrmtLvph48nLCB1bml0OiAn5q+r5Y2HJywgdHlwZTogJ251bWJlcicsIGlkOiAndml0YWxDYXBhY2l0eScgfSxcbiAgICAgIHsgdGV4dDogJ+eri+Wumui3s+i/nCcsIHVuaXQ6ICfnsbMnLCB0eXBlOiAnZGlnaXQnLCBpZDogJ3N0YW5kaW5nTG9uZ0p1bXAnIH0sXG4gICAgICB7IHRleHQ6ICc1MOexs+i3kScsIHVuaXQ6ICfnp5InLCB0eXBlOiAnZGlnaXQnLCBpZDogJ3Nob3J0UnVuJyB9XG4gICAgXSxcbiAgICBsb25nUnVuOiB7IHRleHQ6ICc4MDDnsbPot5EnIH0sXG4gICAgc3BlY2lhbDogeyB0ZXh0OiAn5Luw5Y2n6LW35Z2QJywgdW5pdDogJ+S4qicsIGlkOiAnc2l0dXAnIH0sXG4gICAgUEVzY29yZToge30sXG4gICAgcmVzdWx0OiB7fSxcbiAgICBzY29yZUxpc3Q6IFtcbiAgICAgIHsgdGV4dDogJ0JNSScsIGlkOiAnQk1JJyB9LFxuICAgICAgeyB0ZXh0OiAn5Z2Q5L2N5L2T5YmN5bGIJywgaWQ6ICdzaXRBbmRSZWFjaCcgfSxcbiAgICAgIHsgdGV4dDogJ+iCuua0u+mHjycsIGlkOiAndml0YWxDYXBhY2l0eScgfSxcbiAgICAgIHsgdGV4dDogJ+eri+Wumui3s+i/nCcsIGlkOiAnc3RhbmRpbmdMb25nSnVtcCcgfSxcbiAgICAgIHsgdGV4dDogJzUw57Gz6LeRJywgaWQ6ICdzaG9ydFJ1bicgfVxuICAgIF1cbiAgfSxcbiAgb25Mb2FkKG9wdGlvbjogYW55KSB7XG4gICAgJHBhZ2UuU2V0KHsgb3B0aW9uLCBjdHg6IHRoaXMgfSwgdGhpcy5kYXRhLnBhZ2UpO1xuICAgIGNvbnN0IGdlbmRlckluZGV4ID0gd3guZ2V0U3RvcmFnZVN5bmMoJ2dlbmRlcicpO1xuICAgIGNvbnN0IGdyYWRlSW5kZXggPSB3eC5nZXRTdG9yYWdlU3luYygnZ3JhZGUnKTtcblxuICAgIC8vIOWwhueUqOaIt+S4iuasoemAieaLqeeahOaAp+WIq+WSjOW5tOe6p+i9veWFpVxuICAgIGlmIChnZW5kZXJJbmRleCB8fCBnZW5kZXJJbmRleCA9PT0gMCkgIC8vIOaUueWPmOeJueWIq+mhueebruWSjOmVv+i3keeahOWQjeensFxuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgJ2dlbmRlci5pbmRleCc6IGdlbmRlckluZGV4LFxuICAgICAgICAnbG9uZ1J1bi50ZXh0JzogZ2VuZGVySW5kZXggPT09IDAgPyBsb25nUnVuVGV4dFswXSA6IGxvbmdSdW5UZXh0WzFdLFxuICAgICAgICBzcGVjaWFsOiBnZW5kZXJJbmRleCA9PT0gMCA/IHNwZWNpYWxbMF0gOiBzcGVjaWFsWzFdLFxuICAgICAgICAncmVzdWx0LmdlbmRlcic6IHRoaXMuZGF0YS5nZW5kZXIudmFsdWVbZ2VuZGVySW5kZXhdXG4gICAgICB9KTtcblxuICAgIGlmIChncmFkZUluZGV4IHx8IGdyYWRlSW5kZXggPT09IDApIC8vIOWGmeWFpeW5tOe6p1xuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgJ2dyYWRlLmluZGV4JzogZ3JhZGVJbmRleCxcbiAgICAgICAgJ3Jlc3VsdC5ncmFkZSc6IHRoaXMuZGF0YS5ncmFkZS52YWx1ZVtncmFkZUluZGV4XVxuICAgICAgfSk7XG5cbiAgICAvLyDorr7nva7plb/ot5HpgInmi6nlmajmlbDmja5cbiAgICB0aGlzLnNldERhdGEoeyAnbG9uZ1J1bi5waWNrZXInOiBsb25nUnVuUGlja2VyIH0pO1xuXG4gICAgLy8g6K6+572u6IO25ZuK5ZKM6IOM5pmv6aKc6ImyXG4gICAgY29uc3QgW25jLCBiY10gPSAkcGFnZS5jb2xvcih0cnVlKTtcblxuICAgIHd4LnNldE5hdmlnYXRpb25CYXJDb2xvcihuYyk7XG4gICAgd3guc2V0QmFja2dyb3VuZENvbG9yKGJjKTtcblxuICAgIC8vIOiuvue9rumAmuefpVxuICAgICRwYWdlLk5vdGljZSgnUEVjYWwnKTtcbiAgfSxcbiAgb25QYWdlU2Nyb2xsKGU6IGFueSkge1xuICAgICRjb21wb25lbnQubmF2KGUsIHRoaXMpO1xuICB9LFxuICBjQShlOiBhbnkpIHtcbiAgICAkY29tcG9uZW50LnRyaWdnZXIoZSwgdGhpcyk7XG4gIH0sXG4gIGdlbmRlckNoYW5nZShldmVudDogYW55KSB7XG4gICAgY29uc3QgaW5kZXggPSBOdW1iZXIoZXZlbnQuZGV0YWlsLnZhbHVlKTtcbiAgICBjb25zdCBnZW5kZXIgPSB0aGlzLmRhdGEuZ2VuZGVyLnZhbHVlW2luZGV4XTtcblxuICAgIHd4LnNldFN0b3JhZ2VTeW5jKCdnZW5kZXInLCBpbmRleCk7XG5cbiAgICAvLyDmlLnlj5jnibnliKvpobnnm67lkozplb/ot5HnmoTlkI3np7BcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgJ3Jlc3VsdC5nZW5kZXInOiBnZW5kZXIsXG4gICAgICAnZ2VuZGVyLmluZGV4JzogaW5kZXgsXG4gICAgICBzcGVjaWFsOiBnZW5kZXIgPT09ICdtYWxlJyA/IHNwZWNpYWxbMF0gOiBzcGVjaWFsWzFdLFxuICAgICAgJ2xvbmdSdW4udGV4dCc6IGdlbmRlciA9PT0gJ21hbGUnID8gbG9uZ1J1blRleHRbMF0gOiBsb25nUnVuVGV4dFsxXVxuICAgIH0pO1xuICB9LFxuICBncmFkZUNoYW5nZShldmVudDogYW55KSB7XG4gICAgY29uc3QgaW5kZXggPSBOdW1iZXIoZXZlbnQuZGV0YWlsLnZhbHVlKTtcblxuICAgIC8vIOiuvue9ruW5tOe6p1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAnZ3JhZGUuaW5kZXgnOiBpbmRleCxcbiAgICAgICdyZXN1bHQuZ3JhZGUnOiB0aGlzLmRhdGEuZ3JhZGUudmFsdWVbaW5kZXhdXG4gICAgfSk7XG4gICAgd3guc2V0U3RvcmFnZVN5bmMoJ2dyYWRlJywgaW5kZXgpO1xuICB9LFxuICBmb2N1cyhldmVudDogYW55KSB7XG4gICAgY29uc29sZS5sb2coJ2ZvY3VzJywgZXZlbnQpO1xuICAgIGNvbnN0IHsgaWQgfSA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgY29uc3QgcXVlcnkgPSB3eC5jcmVhdGVTZWxlY3RvclF1ZXJ5KCk7XG5cbiAgICB0aGlzLnNldERhdGEoeyBpbnB1dDogeyBzdGF0dXM6IHRydWUsIGhlaWdodDogZXZlbnQuZGV0YWlsLmhlaWdodCB9IH0pO1xuXG4gICAgcXVlcnkuc2VsZWN0KGAjJHtpZH1gKVxuICAgICAgLmJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHF1ZXJ5LnNlbGVjdFZpZXdwb3J0KCkuZmllbGRzKHsgc2l6ZTogdHJ1ZSwgc2Nyb2xsT2Zmc2V0OiB0cnVlIH0pO1xuICAgIHF1ZXJ5LmV4ZWMoKHJlczogYW55KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgY29uc29sZS5sb2coJ2JvdHRvbeaYrycsIHJlc1swXS5ib3R0b20pO1xuICAgICAgY29uc29sZS5sb2coJ3Njcm9sbFRvcOaYrycsIHJlc1sxXS5zY3JvbGxUb3ApO1xuICAgICAgY29uc29sZS5sb2coJ+mUruebmOmrmOW6puaYrycsIGV2ZW50LmRldGFpbC5oZWlnaHQpO1xuICAgICAgY29uc29sZS5sb2coJ+Wxj+W5lemrmOW6puS4uicsIHJlc1sxXS5oZWlnaHQpO1xuICAgICAgY29uc29sZS5sb2cocmVzWzBdLmJvdHRvbSArIGV2ZW50LmRldGFpbC5oZWlnaHQgPiByZXNbMV0uaGVpZ2h0KTtcbiAgICAgIGlmIChyZXNbMF0uYm90dG9tICsgZXZlbnQuZGV0YWlsLmhlaWdodCA+IHJlc1sxXS5oZWlnaHQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3Njcm9sbCcpO1xuICAgICAgICBjb25zb2xlLmxvZygn6K6h5YiS5ZCR5LiK5rua5YqoJywgcmVzWzBdLmJvdHRvbSArIGV2ZW50LmRldGFpbC5oZWlnaHQgLSByZXNbMV0uaGVpZ2h0ICsgMTApO1xuICAgICAgICBjb25zb2xlLmxvZygn5paw55qE5bqU5Li6JywgcmVzWzFdLnNjcm9sbFRvcCArIHJlc1swXS5ib3R0b20gKyBldmVudC5kZXRhaWwuaGVpZ2h0IC0gcmVzWzFdLmhlaWdodCArIDEwKTtcbiAgICAgICAgd3gucGFnZVNjcm9sbFRvKHsgc2Nyb2xsVG9wOiByZXNbMV0uc2Nyb2xsVG9wICsgcmVzWzBdLmJvdHRvbSArIGV2ZW50LmRldGFpbC5oZWlnaHQgLSByZXNbMV0uaGVpZ2h0ICsgMTAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG4gIGlucHV0KGV2ZW50OiBhbnkpIHtcbiAgICBjb25zb2xlLmxvZyhldmVudCk7XG4gICAgY29uc3QgcHJvamVjdCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuaWQ7XG5cbiAgICB0aGlzLnNldERhdGEoeyBbYHJlc3VsdC4ke3Byb2plY3R9YF06IGV2ZW50LmRldGFpbC52YWx1ZSB9KTtcbiAgfSxcbiAgYmx1cigpIHtcbiAgICB0aGlzLnNldERhdGEoeyAnaW5wdXQuc3RhdHVzJzogZmFsc2UgfSk7XG4gIH0sXG4gIGxvbmdSdW5IYW5kbGVyKGV2ZW50OiBhbnkpIHtcbiAgICBjb25zdCB7IHZhbHVlIH0gPSBldmVudC5kZXRhaWw7XG5cbiAgICAvLyDorr7nva7mmL7npLrmlbDmja5cbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgJ2xvbmdSdW4udmFsdWUnOiBgJHtsb25nUnVuUGlja2VyWzBdW3ZhbHVlWzBdXX0gJHtsb25nUnVuUGlja2VyWzFdW3ZhbHVlWzFdXX1gLFxuICAgICAgJ3Jlc3VsdC5sb25nUnVuJzogKHZhbHVlWzBdICsgMikgKiA2MCArIHZhbHVlWzFdXG4gICAgfSk7XG5cblxuICB9LFxuICBjYWxjdWxhdGUoKSB7XG4gICAgY29uc3QgeyByZXN1bHQgfSA9IHRoaXMuZGF0YTtcblxuICAgIHd4LnNob3dMb2FkaW5nKHsgdGl0bGU6ICforqHnrpfkuK0uLi4nLCBtYXNrOiB0cnVlIH0pO1xuICAgIGNvbnNvbGUuaW5mbygn6L6T5YWl57uT5p6c5Li677yaJywgcmVzdWx0KTtcblxuICAgIGlmIChyZXN1bHQuZ2VuZGVyICYmIHJlc3VsdC5ncmFkZSkgeyAvLyDlj6/ku6XorqHnrpdcbiAgICAgIGNvbnN0IGhhc2ggPSBbMTAsIDIwLCAzMCwgNDAsIDUwLCA2MCwgNjIsIDY0LCA2NiwgNjgsIDcwLCA3MiwgNzQsIDc2LCA3OCwgODAsIDg1LCA5MCwgOTUsIDEwMF07XG4gICAgICBjb25zdCB7IGxlbmd0aCB9ID0gaGFzaDtcbiAgICAgIGNvbnN0IFBFc2NvcmUgPSB7XG4gICAgICAgIEJNSTogMCxcbiAgICAgICAgdml0YWxDYXBhY2l0eTogMCxcbiAgICAgICAgc2l0QW5kUmVhY2g6IDAsXG4gICAgICAgIHN0YW5kaW5nTG9uZ0p1bXA6IDAsXG4gICAgICAgIHNob3J0UnVuOiAwLFxuICAgICAgICBsb25nUnVuOiAwLFxuICAgICAgICBzcGVjaWFsOiAwXG4gICAgICB9O1xuXG4gICAgICBpZiAocmVzdWx0LmhlaWdodCAmJiByZXN1bHQud2VpZ2h0KSB7IC8vIOWPr+S7peiuoeeul0JNSVxuICAgICAgICBsZXQgc3RhdGU7XG4gICAgICAgIGNvbnN0IHNjb3JlID0gTWF0aC5yb3VuZChyZXN1bHQud2VpZ2h0ICogMTAwMDAwIC8gcmVzdWx0LmhlaWdodCAvIHJlc3VsdC5oZWlnaHQpIC8gMTA7XG5cbiAgICAgICAgLy8g6K6h566XQk1J54q25oCB5LiO5YiG5YC8XG4gICAgICAgIFtzdGF0ZSwgUEVzY29yZS5CTUldID0gcmVzdWx0LmdlbmRlciA9PT0gJ21hbGUnXG4gICAgICAgICAgPyBzY29yZSA8PSAxNy44ID8gWyfkvY7kvZPph40nLCA4MF0gOiBzY29yZSA+PSAyOC4wID8gWyfogqXog5YnLCA2MF0gOiBzY29yZSA+PSAyNC4wID8gWyfotoXph40nLCA4MF0gOiBbJ+ato+W4uCcsIDEwMF1cbiAgICAgICAgICA6IHNjb3JlIDw9IDE3LjEgPyBbJ+S9juS9k+mHjScsIDgwXSA6IHNjb3JlID49IDI4LjAgPyBbJ+iCpeiDlicsIDYwXSA6IHNjb3JlID49IDI0LjAgPyBbJ+i2hemHjScsIDgwXSA6IFsn5q2j5bi4JywgMTAwXTtcblxuICAgICAgICAvLyDorqHnrpflj4rmoLzliIbmlbBcbiAgICAgICAgUEVzY29yZS5wYXNzU2NvcmUgPSByZXN1bHQuZ3JhZGUgPT09ICdMb3cnXG4gICAgICAgICAgPyBzY29yZSA8PSAyOCA/IDYwIDogNjAgLSBNYXRoLmNlaWwoc2NvcmUgLSAyOCkgKiAyXG4gICAgICAgICAgOiA1MDtcblxuICAgICAgICB0aGlzLnNldERhdGEoeyBCTUk6IHsgc2NvcmUsIHN0YXRlIH0gfSk7XG4gICAgICB9XG5cbiAgICAgICRmaWxlLmdldEpzb24oYGZ1bmN0aW9uL1BFY2FsLyR7cmVzdWx0LmdlbmRlcn0ke3Jlc3VsdC5ncmFkZX1gLCAoY29uZmlnOiBhbnkpID0+IHsgLy8g6K+75Y+W55u45bqU6YWN572u5paH5Lu2XG5cbiAgICAgICAgLy8g6L2s5o2i6ZW/6LeR5pe26Ze0XG4gICAgICAgIGNvbmZpZy5sb25nUnVuID0gY29uZmlnLmxvbmdSdW4ubWFwKChlbGVtZW50OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICBjb25zdCB0aW1lID0gZWxlbWVudC5zcGxpdCgnLScpO1xuXG4gICAgICAgICAgcmV0dXJuIE51bWJlcih0aW1lWzBdKSAqIDYwICsgTnVtYmVyKHRpbWVbMV0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyDovazmjaLnq4vlrprot7Pov5zljZXkvY1cbiAgICAgICAgY29uZmlnLnN0YW5kaW5nTG9uZ0p1bXAgPSBjb25maWcuc3RhbmRpbmdMb25nSnVtcC5tYXAoKGVsZW1lbnQ6IG51bWJlcikgPT4gZWxlbWVudCAvIDEwMCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coY29uZmlnKTtcblxuICAgICAgICAvLyDku6XkuIvkuInpobnotorpq5jotorlpb3vvIzov5vooYzorqHnrpdcbiAgICAgICAgWyd2aXRhbENhcGFjaXR5JywgJ3NpdEFuZFJlYWNoJywgJ3N0YW5kaW5nTG9uZ0p1bXAnXS5mb3JFYWNoKHggPT4ge1xuICAgICAgICAgIGlmIChyZXN1bHRbeF0pIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgIGlmIChyZXN1bHRbeF0gPD0gY29uZmlnW3hdW2ldKSB7XG4gICAgICAgICAgICAgICAgUEVzY29yZVt4XSA9IGhhc2hbaV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gbGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgICBQRXNjb3JlW3hdID0gaGFzaFtpXTtcbiAgICAgICAgICB9IGVsc2UgUEVzY29yZVt4XSA9IDA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIOS7peS4i+S4pOmhuei2iuS9jui2iuWlvVxuICAgICAgICBbJ3Nob3J0UnVuJywgJ2xvbmdSdW4nXS5mb3JFYWNoKHggPT4ge1xuICAgICAgICAgIGlmIChyZXN1bHRbeF0pIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgIGlmIChyZXN1bHRbeF0gPj0gY29uZmlnW3hdW2ldKSB7XG4gICAgICAgICAgICAgICAgUEVzY29yZVt4XSA9IGhhc2hbaV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gbGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgICBQRXNjb3JlW3hdID0gaGFzaFtpXTtcbiAgICAgICAgICB9IGVsc2UgUEVzY29yZVt4XSA9IDA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIOiuoeeul+eJueWIq+exu+mhueebruWIhuaVsFxuICAgICAgICBjb25zdCBzcGVjaWFsU2NvcmUgPSByZXN1bHQuZ2VuZGVyID09PSAnbWFsZScgPyAnY2hpbm5pbmcnIDogJ3NpdHVwJztcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKVxuICAgICAgICAgIGlmIChyZXN1bHRbc3BlY2lhbFNjb3JlXSkge1xuICAgICAgICAgICAgaWYgKGNvbmZpZ1tzcGVjaWFsU2NvcmVdW2ldICE9PSAnJyAmJiByZXN1bHRbc3BlY2lhbFNjb3JlXSAmJiByZXN1bHRbc3BlY2lhbFNjb3JlXSA8PSBjb25maWdbc3BlY2lhbFNjb3JlXVtpXSkge1xuICAgICAgICAgICAgICBQRXNjb3JlLnNwZWNpYWwgPSBoYXNoW2ldO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gbGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgUEVzY29yZS5zcGVjaWFsID0gaGFzaFtpXTtcbiAgICAgICAgICB9IGVsc2UgUEVzY29yZS5zcGVjaWFsID0gMDtcblxuICAgICAgICAvLyBUT0RPOuiuoeeul+WKoOWIhlxuXG5cbiAgICAgICAgLy8g6K6h566X5pyA57uI5oiQ57upXG4gICAgICAgIGNvbnN0IGZpbmFsU2NvcmUgPSAoUEVzY29yZS52aXRhbENhcGFjaXR5ICogMC4xNSArIFBFc2NvcmUuc2hvcnRSdW4gKiAwLjIgKyBQRXNjb3JlLnNpdEFuZFJlYWNoICogMC4xICtcbiAgICAgICAgICBQRXNjb3JlLnN0YW5kaW5nTG9uZ0p1bXAgKiAwLjEgKyBQRXNjb3JlLnNwZWNpYWwgKiAwLjEgKyBQRXNjb3JlLmxvbmdSdW4gKiAwLjIgK1xuICAgICAgICAgIFBFc2NvcmUuQk1JICogMC4xNSkudG9GaXhlZCgyKTtcblxuICAgICAgICBjb25zb2xlLmluZm8oJ+aIkOe7qeS4uicsIFBFc2NvcmUpO1xuICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgIHNob3dTY29yZTogdHJ1ZSxcbiAgICAgICAgICBQRXNjb3JlLFxuICAgICAgICAgIFBFOiB7XG4gICAgICAgICAgICBzY29yZTogZmluYWxTY29yZSxcbiAgICAgICAgICAgIHN0YXRlOiBmaW5hbFNjb3JlID49IFBFc2NvcmUucGFzc1Njb3JlID8gJ+WPiuagvCcgOiAn5LiN5Y+K5qC8J1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHd4LmhpZGVMb2FkaW5nKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHd4LmhpZGVMb2FkaW5nKCk7XG4gICAgICB3eC5zaG93VG9hc3QoeyB0aXRsZTogJ+ivt+mAieaLqeaAp+WIq+W5tOe6pycsIGljb246ICdub25lJywgZHVyYXRpb246IDI1MDAsIGltYWdlOiAnL2ljb24vY2xvc2UucG5nJyB9KTtcbiAgICB9XG4gIH0sXG4gIG5hdmlnYXRlKCkge1xuICAgIHRoaXMuJHJvdXRlKCcvbW9kdWxlL21vZHVsZTE/RnJvbT3kvZPmtYvorqHnrpflmagmYWltPXRlc3QwJmRlcHRoPTEnKTtcbiAgfSxcblxuICByZWRpcmVjdCgpIHtcbiAgICB0aGlzLiRsYXVuY2goJy9wYWdlL21haW4nKTtcbiAgfSxcbiAgb25TaGFyZUFwcE1lc3NhZ2U6ICgpID0+ICh7IHRpdGxlOiAn5L2T5rWL6K6h566X5ZmoJywgcGF0aDogJy9mdW5jdGlvbi9QRWNhbD9zaGFyZT10cnVlJyB9KVxufSk7XG4iXX0=